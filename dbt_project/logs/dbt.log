[0m18:51:03.153056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e2641f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68df14ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68df14ac50>]}


============================== 18:51:03.167613 | 3dca9db0-1051-4b49-ad67-f907f99af7f3 ==============================
[0m18:51:03.167613 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:51:03.168662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:51:03.170248 [info ] [MainThread]: dbt version: 1.7.0
[0m18:51:03.171110 [info ] [MainThread]: python version: 3.10.14
[0m18:51:03.171942 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:51:03.172773 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:51:03.281679 [info ] [MainThread]: Using profiles dir at .
[0m18:51:03.282784 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:51:03.283684 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt_project/dbt_project.yml
[0m18:51:03.284571 [info ] [MainThread]: adapter type: trino
[0m18:51:03.285447 [info ] [MainThread]: adapter version: 1.7.0
[0m18:51:03.349934 [info ] [MainThread]: Configuration:
[0m18:51:03.351027 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:51:03.351997 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:51:03.353052 [info ] [MainThread]: Required dependencies:
[0m18:51:03.353920 [debug] [MainThread]: Executing "git --help"
[0m18:51:03.363906 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:51:03.364914 [debug] [MainThread]: STDERR: "b''"
[0m18:51:03.365693 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:51:03.366532 [info ] [MainThread]: Connection:
[0m18:51:03.367344 [info ] [MainThread]:   host: trino
[0m18:51:03.368156 [info ] [MainThread]:   port: 8080
[0m18:51:03.369062 [info ] [MainThread]:   user: airflow
[0m18:51:03.369898 [info ] [MainThread]:   database: iceberg
[0m18:51:03.370725 [info ] [MainThread]:   schema: default
[0m18:51:03.371554 [info ] [MainThread]:   cert: None
[0m18:51:03.372374 [info ] [MainThread]:   prepared_statements_enabled: True
[0m18:51:03.373231 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:51:03.374254 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m18:51:03.378860 [debug] [MainThread]: Using trino connection "debug"
[0m18:51:03.379750 [debug] [MainThread]: On debug: select 1 as id
[0m18:51:03.380591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:03.748052 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:03.749853 [debug] [MainThread]: On debug: Close
[0m18:51:03.751150 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:51:03.752434 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:51:03.753835 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.645391, "process_user_time": 2.328517, "process_kernel_time": 0.185112, "process_mem_max_rss": "168076", "process_in_blocks": "30800", "process_out_blocks": "2784"}
[0m18:51:03.755005 [debug] [MainThread]: Command `dbt debug` succeeded at 18:51:03.754846 after 0.65 seconds
[0m18:51:03.756107 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:51:03.757360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e2641f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68df047370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68df0472b0>]}
[0m18:51:03.758445 [debug] [MainThread]: Flushing usage events
[0m18:51:07.686780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec198bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf5c6ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf5c6e90>]}


============================== 18:51:07.692917 | e630e7f9-351c-40c0-bfe9-c4dabff01c20 ==============================
[0m18:51:07.692917 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:51:07.693972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:07.903534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf6436a0>]}
[0m18:51:07.978349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf275840>]}
[0m18:51:07.979544 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:51:07.987344 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:51:07.990907 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:51:07.991736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf3e41c0>]}
[0m18:51:09.149854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5feec0d0>]}
[0m18:51:09.171759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf1ca740>]}
[0m18:51:09.172683 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m18:51:09.173525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebf3e6d10>]}
[0m18:51:09.175752 [info ] [MainThread]: 
[0m18:51:09.176947 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:51:09.179162 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m18:51:09.180131 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m18:51:09.195317 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m18:51:09.198126 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m18:51:09.198977 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m18:51:09.199812 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m18:51:09.200625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:09.201424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:09.315947 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:09.316928 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:09.318428 [debug] [ThreadPool]: On list_iceberg: Close
[0m18:51:09.320425 [debug] [ThreadPool]: On list_iceberg: Close
[0m18:51:09.323377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_default_marts)
[0m18:51:09.324414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_default_staging)
[0m18:51:09.325517 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "default_marts"
"
[0m18:51:09.326930 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "default_staging"
"
[0m18:51:09.332687 [debug] [ThreadPool]: Using trino connection "create_iceberg_default_marts"
[0m18:51:09.336690 [debug] [ThreadPool]: Using trino connection "create_iceberg_default_staging"
[0m18:51:09.337922 [debug] [ThreadPool]: On create_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "create_iceberg_default_marts"} */
create schema if not exists "iceberg"."default_marts"
[0m18:51:09.339089 [debug] [ThreadPool]: On create_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "create_iceberg_default_staging"} */
create schema if not exists "iceberg"."default_staging"
[0m18:51:09.340139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:09.341109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:09.391848 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:09.392966 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:09.394490 [debug] [ThreadPool]: On create_iceberg_default_staging: COMMIT
[0m18:51:09.395975 [debug] [ThreadPool]: On create_iceberg_default_marts: COMMIT
[0m18:51:09.396920 [debug] [ThreadPool]: On create_iceberg_default_staging: Close
[0m18:51:09.397847 [debug] [ThreadPool]: On create_iceberg_default_marts: Close
[0m18:51:09.401355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_default_marts, now list_iceberg_default_marts)
[0m18:51:09.402357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_default_staging, now list_iceberg_default_staging)
[0m18:51:09.411132 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m18:51:09.415734 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m18:51:09.416716 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m18:51:09.417579 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m18:51:09.418423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:09.419435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:19.907895 [debug] [ThreadPool]: SQL status: SUCCESS in 10.0 seconds
[0m18:51:19.908782 [debug] [ThreadPool]: SQL status: SUCCESS in 10.0 seconds
[0m18:51:19.910142 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m18:51:19.912118 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m18:51:19.913145 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m18:51:19.914303 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m18:51:19.917344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fd7e890>]}
[0m18:51:19.918736 [debug] [MainThread]: On master: COMMIT
[0m18:51:19.920161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:51:19.921169 [info ] [MainThread]: 
[0m18:51:19.927564 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m18:51:19.928143 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m18:51:19.929188 [info ] [Thread-1 (]: 1 of 4 START sql view model default_staging.stg_products ....................... [RUN]
[0m18:51:19.930191 [info ] [Thread-2 (]: 2 of 4 START sql view model default_staging.stg_sales .......................... [RUN]
[0m18:51:19.931340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_products)
[0m18:51:19.932514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_sales)
[0m18:51:19.933421 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m18:51:19.934385 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m18:51:19.936955 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m18:51:19.939404 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m18:51:19.948977 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 18:51:19.935165 => 18:51:19.948683
[0m18:51:19.950190 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m18:51:19.950806 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 18:51:19.937780 => 18:51:19.950538
[0m18:51:19.971785 [debug] [Thread-1 (]: Writing runtime sql for node "model.iceberg_example.stg_products"
[0m18:51:19.972363 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m18:51:19.976740 [debug] [Thread-2 (]: Writing runtime sql for node "model.iceberg_example.stg_sales"
[0m18:51:19.985886 [debug] [Thread-1 (]: Using trino connection "model.iceberg_example.stg_products"
[0m18:51:19.987020 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_products"} */

  create or replace view
    "iceberg"."default_staging"."stg_products"
  security definer
  as
    with source as (
    select * from iceberg.raw.products
),

renamed as (
    select
        id as product_id,
        name as product_name,
        category,
        price,
        date as created_date
    from source
)

select * from renamed
  
[0m18:51:19.988485 [debug] [Thread-2 (]: Using trino connection "model.iceberg_example.stg_sales"
[0m18:51:19.989382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:19.990285 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_sales"} */

  create or replace view
    "iceberg"."default_staging"."stg_sales"
  security definer
  as
    with source as (
    select * from iceberg.raw.sales
),

renamed as (
    select
        sale_id,
        product_id,
        quantity,
        total as total_amount,
        date as sale_date
    from source
)

select * from renamed
  
[0m18:51:19.992706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:51:20.172661 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:20.173744 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:20.188541 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 18:51:19.951445 => 18:51:20.188332
[0m18:51:20.190596 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 18:51:19.973890 => 18:51:20.190398
[0m18:51:20.191720 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: ROLLBACK
[0m18:51:20.192584 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: ROLLBACK
[0m18:51:20.193380 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: Close
[0m18:51:20.194252 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: Close
[0m18:51:20.195461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fdcace0>]}
[0m18:51:20.196510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fdca170>]}
[0m18:51:20.197354 [info ] [Thread-1 (]: 1 of 4 OK created sql view model default_staging.stg_products .................. [[32mSUCCESS[0m in 0.26s]
[0m18:51:20.198228 [info ] [Thread-2 (]: 2 of 4 OK created sql view model default_staging.stg_sales ..................... [[32mSUCCESS[0m in 0.26s]
[0m18:51:20.199094 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m18:51:20.199990 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m18:51:20.201770 [debug] [Thread-4 (]: Began running node model.iceberg_example.sales_by_category
[0m18:51:20.202338 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m18:51:20.203096 [info ] [Thread-4 (]: 3 of 4 START sql table model default_marts.sales_by_category ................... [RUN]
[0m18:51:20.203901 [info ] [Thread-3 (]: 4 of 4 START sql table model default_marts.sales_by_product .................... [RUN]
[0m18:51:20.204996 [debug] [Thread-4 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_category'
[0m18:51:20.206026 [debug] [Thread-3 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_product'
[0m18:51:20.206870 [debug] [Thread-4 (]: Began compiling node model.iceberg_example.sales_by_category
[0m18:51:20.207660 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m18:51:20.211026 [debug] [Thread-4 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m18:51:20.214189 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m18:51:20.219039 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (compile): 18:51:20.208313 => 18:51:20.218828
[0m18:51:20.219834 [debug] [Thread-4 (]: Began executing node model.iceberg_example.sales_by_category
[0m18:51:20.220364 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 18:51:20.211785 => 18:51:20.220156
[0m18:51:20.242460 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m18:51:20.249638 [debug] [Thread-4 (]: Writing runtime sql for node "model.iceberg_example.sales_by_category"
[0m18:51:20.254449 [debug] [Thread-3 (]: Writing runtime sql for node "model.iceberg_example.sales_by_product"
[0m18:51:20.260826 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m18:51:20.261707 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

  
    

    create table "iceberg"."default_marts"."sales_by_category__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_category as (
    select
        p.category,
        count(distinct p.product_id) as number_of_products,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        avg(s.total_amount / s.quantity) as average_unit_price,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1
)

select * from sales_by_category
    )
[0m18:51:20.264061 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m18:51:20.264767 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:51:20.265575 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

  
    

    create table "iceberg"."default_marts"."sales_by_product__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_product as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price as unit_price,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date,
        count(distinct s.sale_id) as number_of_sales
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1, 2, 3, 4
)

select * from sales_by_product
    )
[0m18:51:20.267730 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:51:21.496021 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:51:21.503132 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:51:21.505067 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m18:51:21.510148 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m18:51:21.511361 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_category"
[0m18:51:21.512468 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_product"
[0m18:51:21.616837 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:21.618125 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:21.625827 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m18:51:21.629631 [debug] [Thread-3 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m18:51:21.632638 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m18:51:21.634408 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m18:51:21.635435 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

    drop table if exists "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m18:51:21.636394 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

    drop table if exists "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m18:51:21.650311 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:21.651321 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:21.653937 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (execute): 18:51:20.220866 => 18:51:21.653720
[0m18:51:21.656788 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 18:51:20.250071 => 18:51:21.656568
[0m18:51:21.657766 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: ROLLBACK
[0m18:51:21.658670 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: ROLLBACK
[0m18:51:21.659624 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: Close
[0m18:51:21.660651 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: Close
[0m18:51:21.662190 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fcbada0>]}
[0m18:51:21.663679 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e630e7f9-351c-40c0-bfe9-c4dabff01c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fc76110>]}
[0m18:51:21.664682 [info ] [Thread-4 (]: 3 of 4 OK created sql table model default_marts.sales_by_category .............. [[32mSUCCESS[0m in 1.46s]
[0m18:51:21.665657 [info ] [Thread-3 (]: 4 of 4 OK created sql table model default_marts.sales_by_product ............... [[32mSUCCESS[0m in 1.46s]
[0m18:51:21.666939 [debug] [Thread-4 (]: Finished running node model.iceberg_example.sales_by_category
[0m18:51:21.668239 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m18:51:21.671467 [debug] [MainThread]: On master: COMMIT
[0m18:51:21.672720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:21.673613 [debug] [MainThread]: Connection 'model.iceberg_example.stg_sales' was properly closed.
[0m18:51:21.674627 [debug] [MainThread]: Connection 'model.iceberg_example.stg_products' was properly closed.
[0m18:51:21.675582 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_category' was properly closed.
[0m18:51:21.676547 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_product' was properly closed.
[0m18:51:21.677857 [info ] [MainThread]: 
[0m18:51:21.678762 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m18:51:21.680102 [debug] [MainThread]: Command end result
[0m18:51:21.738275 [info ] [MainThread]: 
[0m18:51:21.739200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:21.740040 [info ] [MainThread]: 
[0m18:51:21.740854 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:51:21.742085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.488579, "process_user_time": 3.864899, "process_kernel_time": 0.161037, "process_mem_max_rss": "168076", "process_in_blocks": "2536", "process_out_blocks": "0"}
[0m18:51:21.743006 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:21.742865 after 13.49 seconds
[0m18:51:21.743809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec198bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faebfa1f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5fe5a410>]}
[0m18:51:21.744629 [debug] [MainThread]: Flushing usage events
[0m18:51:25.081548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52e014b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50cc7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50cc6fb0>]}


============================== 18:51:25.086610 | 1fcc6c58-ca02-4f10-ac01-a28faa9cc00d ==============================
[0m18:51:25.086610 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:51:25.087562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:25.257169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50dcd330>]}
[0m18:51:25.332532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d509781f0>]}
[0m18:51:25.333870 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:51:25.344392 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:51:25.480367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:25.481234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:25.487498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d507a00d0>]}
[0m18:51:25.494972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50878850>]}
[0m18:51:25.495794 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m18:51:25.496582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50878820>]}
[0m18:51:25.499122 [info ] [MainThread]: 
[0m18:51:25.500208 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:51:25.501614 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_marts'
[0m18:51:25.502637 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_staging'
[0m18:51:25.517854 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m18:51:25.521905 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m18:51:25.522747 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m18:51:25.523545 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m18:51:25.524361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:25.525081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:25.651898 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:25.652880 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:25.654678 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m18:51:25.656579 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m18:51:25.657435 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m18:51:25.658245 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m18:51:25.661224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc6c58-ca02-4f10-ac01-a28faa9cc00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d508786d0>]}
[0m18:51:25.662482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:51:25.663428 [info ] [MainThread]: 
[0m18:51:25.670950 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m18:51:25.671681 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m18:51:25.673061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_products)
[0m18:51:25.674313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_sales)
[0m18:51:25.675200 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m18:51:25.676131 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m18:51:25.678914 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m18:51:25.681377 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m18:51:25.685266 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 18:51:25.676914 => 18:51:25.684986
[0m18:51:25.685806 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 18:51:25.679794 => 18:51:25.685526
[0m18:51:25.686585 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m18:51:25.687569 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m18:51:25.688571 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 18:51:25.688294 => 18:51:25.688310
[0m18:51:25.689502 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 18:51:25.689262 => 18:51:25.689271
[0m18:51:25.690914 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m18:51:25.692430 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m18:51:25.694206 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m18:51:25.694680 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m18:51:25.695170 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m18:51:25.695648 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m18:51:25.697288 [debug] [Thread-4 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_category.6007d8b2d1'
[0m18:51:25.698599 [debug] [Thread-3 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_created_date.db1f142e72'
[0m18:51:25.699778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_products, now test.iceberg_example.not_null_stg_products_price.2d147627d4)
[0m18:51:25.700832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_sales, now test.iceberg_example.not_null_stg_products_product_id.6373b0acf3)
[0m18:51:25.701684 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m18:51:25.702545 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m18:51:25.703351 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m18:51:25.704201 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m18:51:25.717478 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_category.6007d8b2d1"
[0m18:51:25.722472 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_created_date.db1f142e72"
[0m18:51:25.726739 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_price.2d147627d4"
[0m18:51:25.732306 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_id.6373b0acf3"
[0m18:51:25.740252 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (compile): 18:51:25.704866 => 18:51:25.739861
[0m18:51:25.741425 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m18:51:25.742018 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (compile): 18:51:25.723311 => 18:51:25.741758
[0m18:51:25.743006 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (execute): 18:51:25.742733 => 18:51:25.742746
[0m18:51:25.743650 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (compile): 18:51:25.727780 => 18:51:25.743364
[0m18:51:25.744477 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m18:51:25.745095 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (compile): 18:51:25.718233 => 18:51:25.744829
[0m18:51:25.746441 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m18:51:25.747476 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m18:51:25.748553 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (execute): 18:51:25.748319 => 18:51:25.748329
[0m18:51:25.749571 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m18:51:25.750759 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m18:51:25.751978 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (execute): 18:51:25.751690 => 18:51:25.751704
[0m18:51:25.753480 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m18:51:25.754556 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (execute): 18:51:25.754308 => 18:51:25.754319
[0m18:51:25.755790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_category.6007d8b2d1, now test.iceberg_example.not_null_stg_products_product_name.0b59e4b939)
[0m18:51:25.757402 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m18:51:25.758576 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m18:51:25.760607 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m18:51:25.761635 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m18:51:25.762687 [debug] [Thread-2 (]: Began running node model.iceberg_example.sales_by_category
[0m18:51:25.763860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_price.2d147627d4, now test.iceberg_example.unique_stg_products_product_id.7d950a1467)
[0m18:51:25.764811 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m18:51:25.769790 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_name.0b59e4b939"
[0m18:51:25.771008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_id.6373b0acf3, now model.iceberg_example.sales_by_category)
[0m18:51:25.771937 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m18:51:25.773070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_created_date.db1f142e72, now model.iceberg_example.sales_by_product)
[0m18:51:25.774716 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.sales_by_category
[0m18:51:25.781730 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_products_product_id.7d950a1467"
[0m18:51:25.782730 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m18:51:25.786593 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m18:51:25.788148 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (compile): 18:51:25.765659 => 18:51:25.787874
[0m18:51:25.792831 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m18:51:25.794507 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (compile): 18:51:25.775557 => 18:51:25.794240
[0m18:51:25.795093 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m18:51:25.796580 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m18:51:25.797626 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (execute): 18:51:25.797394 => 18:51:25.797407
[0m18:51:25.798643 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (compile): 18:51:25.783645 => 18:51:25.798418
[0m18:51:25.799126 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (execute): 18:51:25.798902 => 18:51:25.798913
[0m18:51:25.799618 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 18:51:25.788803 => 18:51:25.799392
[0m18:51:25.800824 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m18:51:25.801799 [debug] [Thread-2 (]: Began executing node model.iceberg_example.sales_by_category
[0m18:51:25.803088 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m18:51:25.803969 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m18:51:25.804858 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m18:51:25.805753 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (execute): 18:51:25.805537 => 18:51:25.805544
[0m18:51:25.806664 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m18:51:25.807620 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 18:51:25.807405 => 18:51:25.807413
[0m18:51:25.808741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_name.0b59e4b939, now test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276)
[0m18:51:25.810029 [debug] [Thread-2 (]: Finished running node model.iceberg_example.sales_by_category
[0m18:51:25.811160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_products_product_id.7d950a1467, now test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12)
[0m18:51:25.812424 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m18:51:25.813267 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m18:51:25.814203 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m18:51:25.815443 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m18:51:25.816601 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m18:51:25.822010 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276"
[0m18:51:25.823606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_category, now test.iceberg_example.not_null_stg_sales_sale_date.b84165df57)
[0m18:51:25.828682 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12"
[0m18:51:25.830140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_product, now test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929)
[0m18:51:25.832067 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m18:51:25.833788 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m18:51:25.839287 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_date.b84165df57"
[0m18:51:25.844436 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929"
[0m18:51:25.845150 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (compile): 18:51:25.817693 => 18:51:25.844777
[0m18:51:25.845806 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (compile): 18:51:25.824478 => 18:51:25.845448
[0m18:51:25.848051 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m18:51:25.849097 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m18:51:25.850284 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (execute): 18:51:25.849968 => 18:51:25.849985
[0m18:51:25.851531 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (execute): 18:51:25.851270 => 18:51:25.851282
[0m18:51:25.852181 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (compile): 18:51:25.840503 => 18:51:25.851899
[0m18:51:25.853699 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m18:51:25.854220 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (compile): 18:51:25.834658 => 18:51:25.853989
[0m18:51:25.855400 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m18:51:25.856285 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m18:51:25.857346 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m18:51:25.858215 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m18:51:25.859158 [debug] [Thread-1 (]: Began running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m18:51:25.860069 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (execute): 18:51:25.859850 => 18:51:25.859859
[0m18:51:25.861167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276, now test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f)
[0m18:51:25.862107 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (execute): 18:51:25.861880 => 18:51:25.861890
[0m18:51:25.863175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12, now test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d)
[0m18:51:25.864430 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m18:51:25.865248 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m18:51:25.866498 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m18:51:25.867500 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m18:51:25.868378 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m18:51:25.872896 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f"
[0m18:51:25.873836 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m18:51:25.881270 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d"
[0m18:51:25.882294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929, now test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521)
[0m18:51:25.883912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_date.b84165df57, now test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8)
[0m18:51:25.885274 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m18:51:25.886259 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m18:51:25.886887 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (compile): 18:51:25.869065 => 18:51:25.886614
[0m18:51:25.892236 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521"
[0m18:51:25.892805 [debug] [Thread-1 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (compile): 18:51:25.874586 => 18:51:25.892582
[0m18:51:25.896779 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8"
[0m18:51:25.897743 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m18:51:25.899088 [debug] [Thread-1 (]: Began executing node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m18:51:25.900484 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (execute): 18:51:25.900256 => 18:51:25.900268
[0m18:51:25.901410 [debug] [Thread-1 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (execute): 18:51:25.901191 => 18:51:25.901198
[0m18:51:25.902734 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m18:51:25.903966 [debug] [Thread-1 (]: Finished running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m18:51:25.904433 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (compile): 18:51:25.887561 => 18:51:25.904223
[0m18:51:25.905141 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m18:51:25.906007 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m18:51:25.907047 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m18:51:25.908357 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f, now test.iceberg_example.not_null_sales_by_category_category.99acef3343)
[0m18:51:25.909636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d, now test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad)
[0m18:51:25.910207 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (compile): 18:51:25.893336 => 18:51:25.909938
[0m18:51:25.911007 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (execute): 18:51:25.910781 => 18:51:25.910792
[0m18:51:25.911850 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m18:51:25.912724 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m18:51:25.913565 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m18:51:25.914839 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m18:51:25.919483 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_category.99acef3343"
[0m18:51:25.923566 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad"
[0m18:51:25.924540 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (execute): 18:51:25.924308 => 18:51:25.924319
[0m18:51:25.925552 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m18:51:25.928098 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m18:51:25.929497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521, now test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d)
[0m18:51:25.930694 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m18:51:25.931295 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (compile): 18:51:25.920218 => 18:51:25.931071
[0m18:51:25.932054 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m18:51:25.933134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8, now test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d)
[0m18:51:25.933624 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (compile): 18:51:25.915512 => 18:51:25.933410
[0m18:51:25.934237 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m18:51:25.938991 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d"
[0m18:51:25.939850 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m18:51:25.940668 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m18:51:25.941497 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (execute): 18:51:25.941282 => 18:51:25.941292
[0m18:51:25.945874 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d"
[0m18:51:25.947007 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (execute): 18:51:25.946748 => 18:51:25.946755
[0m18:51:25.948187 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m18:51:25.949345 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (compile): 18:51:25.934916 => 18:51:25.949136
[0m18:51:25.950241 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m18:51:25.951111 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m18:51:25.951658 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (compile): 18:51:25.942537 => 18:51:25.951441
[0m18:51:25.952292 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m18:51:25.953177 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m18:51:25.954203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad, now test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87)
[0m18:51:25.955015 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m18:51:25.955859 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (execute): 18:51:25.955650 => 18:51:25.955657
[0m18:51:25.956889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_category.99acef3343, now test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd)
[0m18:51:25.957758 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m18:51:25.958599 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (execute): 18:51:25.958391 => 18:51:25.958397
[0m18:51:25.959717 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m18:51:25.960482 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m18:51:25.964568 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87"
[0m18:51:25.965734 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m18:51:25.966607 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m18:51:25.970604 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd"
[0m18:51:25.971966 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m18:51:25.972947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d, now test.iceberg_example.unique_sales_by_category_category.b77939e04a)
[0m18:51:25.974393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d, now test.iceberg_example.not_null_sales_by_product_category.5dd1b81659)
[0m18:51:25.975227 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m18:51:25.976136 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m18:51:25.976727 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (compile): 18:51:25.961106 => 18:51:25.976481
[0m18:51:25.981400 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_category_category.b77939e04a"
[0m18:51:25.985208 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_category.5dd1b81659"
[0m18:51:25.985681 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (compile): 18:51:25.967337 => 18:51:25.985474
[0m18:51:25.986344 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m18:51:25.988218 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m18:51:25.989072 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (execute): 18:51:25.988860 => 18:51:25.988869
[0m18:51:25.989974 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (execute): 18:51:25.989764 => 18:51:25.989770
[0m18:51:25.990697 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (compile): 18:51:25.977372 => 18:51:25.990492
[0m18:51:25.991610 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m18:51:25.992081 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (compile): 18:51:25.982167 => 18:51:25.991858
[0m18:51:25.993212 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m18:51:25.993963 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m18:51:25.994793 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m18:51:25.995607 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m18:51:25.996415 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m18:51:25.997378 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (execute): 18:51:25.997172 => 18:51:25.997178
[0m18:51:25.998375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87, now test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e)
[0m18:51:25.999232 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (execute): 18:51:25.999021 => 18:51:25.999027
[0m18:51:26.000177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd, now test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132)
[0m18:51:26.001313 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m18:51:26.002071 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m18:51:26.003198 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m18:51:26.003944 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m18:51:26.004764 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m18:51:26.008647 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e"
[0m18:51:26.009627 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m18:51:26.013526 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132"
[0m18:51:26.014617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_sales_by_category_category.b77939e04a, now test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e)
[0m18:51:26.016066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_category.5dd1b81659, now test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371)
[0m18:51:26.017369 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m18:51:26.018224 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m18:51:26.019179 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (compile): 18:51:26.005413 => 18:51:26.018968
[0m18:51:26.022792 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e"
[0m18:51:26.026859 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371"
[0m18:51:26.027368 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (compile): 18:51:26.010267 => 18:51:26.027161
[0m18:51:26.028012 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m18:51:26.029761 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m18:51:26.030659 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (execute): 18:51:26.030438 => 18:51:26.030448
[0m18:51:26.031584 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (execute): 18:51:26.031372 => 18:51:26.031378
[0m18:51:26.032073 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (compile): 18:51:26.019440 => 18:51:26.031865
[0m18:51:26.033147 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m18:51:26.033622 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (compile): 18:51:26.023568 => 18:51:26.033401
[0m18:51:26.034634 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m18:51:26.035424 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m18:51:26.036289 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m18:51:26.037176 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m18:51:26.038074 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m18:51:26.039215 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (execute): 18:51:26.039003 => 18:51:26.039009
[0m18:51:26.040290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e, now test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710)
[0m18:51:26.041196 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (execute): 18:51:26.040987 => 18:51:26.040993
[0m18:51:26.042195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132, now test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873)
[0m18:51:26.043382 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m18:51:26.044208 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m18:51:26.045406 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m18:51:26.046193 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m18:51:26.047109 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m18:51:26.051308 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710"
[0m18:51:26.052166 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m18:51:26.056975 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873"
[0m18:51:26.057989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e, now test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6)
[0m18:51:26.059588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371, now test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc)
[0m18:51:26.060865 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m18:51:26.061649 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m18:51:26.065468 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6"
[0m18:51:26.065967 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (compile): 18:51:26.047786 => 18:51:26.065758
[0m18:51:26.069665 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc"
[0m18:51:26.070145 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (compile): 18:51:26.052806 => 18:51:26.069936
[0m18:51:26.071245 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m18:51:26.072519 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m18:51:26.073422 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (execute): 18:51:26.073213 => 18:51:26.073221
[0m18:51:26.074415 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (execute): 18:51:26.074202 => 18:51:26.074208
[0m18:51:26.074912 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (compile): 18:51:26.062389 => 18:51:26.074706
[0m18:51:26.076025 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m18:51:26.076492 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (compile): 18:51:26.066518 => 18:51:26.076285
[0m18:51:26.077534 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m18:51:26.078381 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m18:51:26.079221 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m18:51:26.080057 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m18:51:26.081346 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (execute): 18:51:26.081126 => 18:51:26.081132
[0m18:51:26.082350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710, now test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c)
[0m18:51:26.083196 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (execute): 18:51:26.082992 => 18:51:26.082998
[0m18:51:26.084335 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m18:51:26.085090 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m18:51:26.086221 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m18:51:26.090560 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c"
[0m18:51:26.096758 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (compile): 18:51:26.087449 => 18:51:26.096549
[0m18:51:26.097504 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m18:51:26.098384 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (execute): 18:51:26.098175 => 18:51:26.098182
[0m18:51:26.099471 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m18:51:26.100919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:26.101618 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc' was properly closed.
[0m18:51:26.102337 [debug] [MainThread]: Connection 'test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c' was properly closed.
[0m18:51:26.103063 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873' was properly closed.
[0m18:51:26.103761 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6' was properly closed.
[0m18:51:26.107587 [debug] [MainThread]: Command end result
[0m18:51:26.134522 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m18:51:26.135278 [info ] [MainThread]: Building catalog
[0m18:51:26.137217 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m18:51:26.161923 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m18:51:26.162780 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_products'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_sales'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_category'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_product'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m18:51:26.163594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:26.594209 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:26.600591 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m18:51:26.622062 [info ] [MainThread]: Catalog written to /opt/airflow/dbt_project/target/catalog.json
[0m18:51:26.623499 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.58219, "process_user_time": 2.87881, "process_kernel_time": 0.131853, "process_mem_max_rss": "168080", "process_in_blocks": "2944", "process_out_blocks": "0"}
[0m18:51:26.624517 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:51:26.624364 after 1.58 seconds
[0m18:51:26.625314 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:51:26.626094 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m18:51:26.626940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52e014b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d50b98e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d509781f0>]}
[0m18:51:26.627859 [debug] [MainThread]: Flushing usage events
[0m19:29:53.280160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05973f1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05949cee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05949cee30>]}


============================== 19:29:53.285131 | cf8abc0c-1d01-49a9-adc8-7b8e000e8db9 ==============================
[0m19:29:53.285131 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:29:53.286106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m19:29:53.287400 [info ] [MainThread]: dbt version: 1.7.0
[0m19:29:53.288217 [info ] [MainThread]: python version: 3.10.14
[0m19:29:53.289057 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:29:53.289790 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:29:53.392715 [info ] [MainThread]: Using profiles dir at .
[0m19:29:53.393843 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m19:29:53.394740 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt_project/dbt_project.yml
[0m19:29:53.395577 [info ] [MainThread]: adapter type: trino
[0m19:29:53.396354 [info ] [MainThread]: adapter version: 1.7.0
[0m19:29:53.469648 [info ] [MainThread]: Configuration:
[0m19:29:53.470833 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:29:53.471760 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:29:53.472656 [info ] [MainThread]: Required dependencies:
[0m19:29:53.473627 [debug] [MainThread]: Executing "git --help"
[0m19:29:53.476083 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:29:53.476965 [debug] [MainThread]: STDERR: "b''"
[0m19:29:53.477824 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:29:53.478667 [info ] [MainThread]: Connection:
[0m19:29:53.479503 [info ] [MainThread]:   host: trino
[0m19:29:53.480360 [info ] [MainThread]:   port: 8080
[0m19:29:53.481161 [info ] [MainThread]:   user: airflow
[0m19:29:53.481970 [info ] [MainThread]:   database: iceberg
[0m19:29:53.482844 [info ] [MainThread]:   schema: default
[0m19:29:53.483897 [info ] [MainThread]:   cert: None
[0m19:29:53.484763 [info ] [MainThread]:   prepared_statements_enabled: True
[0m19:29:53.485669 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:29:53.486618 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m19:29:53.491072 [debug] [MainThread]: Using trino connection "debug"
[0m19:29:53.491969 [debug] [MainThread]: On debug: select 1 as id
[0m19:29:53.492773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:53.508294 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:53.509864 [debug] [MainThread]: On debug: Close
[0m19:29:53.510804 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:29:53.511697 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:29:53.512974 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2745027, "process_user_time": 2.207584, "process_kernel_time": 0.1515, "process_mem_max_rss": "168176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:29:53.513858 [debug] [MainThread]: Command `dbt debug` succeeded at 19:29:53.513720 after 0.28 seconds
[0m19:29:53.514634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:29:53.515405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05973f1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0594b18e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0594b1a980>]}
[0m19:29:53.516212 [debug] [MainThread]: Flushing usage events
[0m19:29:57.624044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ebb50c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8ae2fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8ae2f80>]}


============================== 19:29:57.628996 | d40e9d2e-a8b0-45ff-acfb-fdaf292be66b ==============================
[0m19:29:57.628996 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:29:57.629929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:57.800577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8c37520>]}
[0m19:29:57.870057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8797550>]}
[0m19:29:57.871093 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:29:57.881122 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:29:57.937558 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:29:57.938676 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:29:57.939521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8904d00>]}
[0m19:29:58.976459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb123c0d0>]}
[0m19:29:58.997128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8904f10>]}
[0m19:29:58.998065 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m19:29:58.998894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb80c3e50>]}
[0m19:29:59.000993 [info ] [MainThread]: 
[0m19:29:59.002200 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:29:59.003711 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m19:29:59.004603 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m19:29:59.019918 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m19:29:59.022937 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m19:29:59.023941 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m19:29:59.024768 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m19:29:59.025570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:59.026339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:59.050614 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.051768 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.053515 [debug] [ThreadPool]: On list_iceberg: Close
[0m19:29:59.055192 [debug] [ThreadPool]: On list_iceberg: Close
[0m19:29:59.058341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_marts)
[0m19:29:59.059165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_staging)
[0m19:29:59.067165 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m19:29:59.071507 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m19:29:59.072580 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m19:29:59.073433 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m19:29:59.074324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:59.075091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:59.134811 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.135583 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.137157 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m19:29:59.138803 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m19:29:59.139642 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m19:29:59.140448 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m19:29:59.143831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb1295f00>]}
[0m19:29:59.144813 [debug] [MainThread]: On master: COMMIT
[0m19:29:59.145903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:59.146848 [info ] [MainThread]: 
[0m19:29:59.153899 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m19:29:59.154413 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m19:29:59.155304 [info ] [Thread-1 (]: 1 of 4 START sql view model default_staging.stg_products ....................... [RUN]
[0m19:29:59.156237 [info ] [Thread-2 (]: 2 of 4 START sql view model default_staging.stg_sales .......................... [RUN]
[0m19:29:59.157355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_products)
[0m19:29:59.158896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_sales)
[0m19:29:59.159890 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m19:29:59.160754 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m19:29:59.163380 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m19:29:59.165710 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m19:29:59.169957 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 19:29:59.161512 => 19:29:59.169709
[0m19:29:59.170519 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 19:29:59.164108 => 19:29:59.170291
[0m19:29:59.171230 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m19:29:59.172187 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m19:29:59.193089 [debug] [Thread-1 (]: Writing runtime sql for node "model.iceberg_example.stg_products"
[0m19:29:59.196522 [debug] [Thread-2 (]: Writing runtime sql for node "model.iceberg_example.stg_sales"
[0m19:29:59.201611 [debug] [Thread-1 (]: Using trino connection "model.iceberg_example.stg_products"
[0m19:29:59.203046 [debug] [Thread-2 (]: Using trino connection "model.iceberg_example.stg_sales"
[0m19:29:59.203814 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_products"} */

  create or replace view
    "iceberg"."default_staging"."stg_products"
  security definer
  as
    with source as (
    select * from iceberg.raw.products
),

renamed as (
    select
        id as product_id,
        name as product_name,
        category,
        price,
        date as created_date
    from source
)

select * from renamed
  
[0m19:29:59.204754 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_sales"} */

  create or replace view
    "iceberg"."default_staging"."stg_sales"
  security definer
  as
    with source as (
    select * from iceberg.raw.sales
),

renamed as (
    select
        sale_id,
        product_id,
        quantity,
        total as total_amount,
        date as sale_date
    from source
)

select * from renamed
  
[0m19:29:59.205632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:59.206435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:59.237906 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.238953 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.254987 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 19:29:59.172945 => 19:29:59.254779
[0m19:29:59.257567 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 19:29:59.193436 => 19:29:59.257355
[0m19:29:59.258527 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: ROLLBACK
[0m19:29:59.259432 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: ROLLBACK
[0m19:29:59.260222 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: Close
[0m19:29:59.261075 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: Close
[0m19:29:59.262344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb10ec3d0>]}
[0m19:29:59.263453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb10ec5e0>]}
[0m19:29:59.264372 [info ] [Thread-1 (]: 1 of 4 OK created sql view model default_staging.stg_products .................. [[32mSUCCESS[0m in 0.11s]
[0m19:29:59.265435 [info ] [Thread-2 (]: 2 of 4 OK created sql view model default_staging.stg_sales ..................... [[32mSUCCESS[0m in 0.11s]
[0m19:29:59.266444 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m19:29:59.267428 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m19:29:59.269402 [debug] [Thread-4 (]: Began running node model.iceberg_example.sales_by_category
[0m19:29:59.269943 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m19:29:59.270728 [info ] [Thread-4 (]: 3 of 4 START sql table model default_marts.sales_by_category ................... [RUN]
[0m19:29:59.271609 [info ] [Thread-3 (]: 4 of 4 START sql table model default_marts.sales_by_product .................... [RUN]
[0m19:29:59.272814 [debug] [Thread-4 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_category'
[0m19:29:59.273944 [debug] [Thread-3 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_product'
[0m19:29:59.274776 [debug] [Thread-4 (]: Began compiling node model.iceberg_example.sales_by_category
[0m19:29:59.275633 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m19:29:59.279482 [debug] [Thread-4 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m19:29:59.282855 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m19:29:59.287457 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (compile): 19:29:59.276302 => 19:29:59.287179
[0m19:29:59.288118 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 19:29:59.280184 => 19:29:59.287908
[0m19:29:59.288703 [debug] [Thread-4 (]: Began executing node model.iceberg_example.sales_by_category
[0m19:29:59.289541 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m19:29:59.329271 [debug] [Thread-4 (]: Writing runtime sql for node "model.iceberg_example.sales_by_category"
[0m19:29:59.329875 [debug] [Thread-3 (]: Writing runtime sql for node "model.iceberg_example.sales_by_product"
[0m19:29:59.335512 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m19:29:59.337877 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m19:29:59.338598 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

  
    

    create table "iceberg"."default_marts"."sales_by_category__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_category as (
    select
        p.category,
        count(distinct p.product_id) as number_of_products,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        avg(s.total_amount / s.quantity) as average_unit_price,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1
)

select * from sales_by_category
    )
[0m19:29:59.339482 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

  
    

    create table "iceberg"."default_marts"."sales_by_product__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_product as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price as unit_price,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date,
        count(distinct s.sale_id) as number_of_sales
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1, 2, 3, 4
)

select * from sales_by_product
    )
[0m19:29:59.340301 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:29:59.341103 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:29:59.816133 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.824141 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m19:29:59.824966 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.825749 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product" rename to "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m19:29:59.829325 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m19:29:59.831724 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category" rename to "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m19:29:59.859046 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.864659 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m19:29:59.865765 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.866758 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_product"
[0m19:29:59.871335 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m19:29:59.873916 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_category"
[0m19:29:59.902262 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.903359 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:29:59.911344 [debug] [Thread-3 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m19:29:59.916130 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m19:29:59.918687 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m19:29:59.920020 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m19:29:59.920862 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

    drop table if exists "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m19:29:59.921736 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

    drop table if exists "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m19:30:00.145652 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:30:00.147019 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:30:00.149727 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (execute): 19:29:59.290195 => 19:30:00.149518
[0m19:30:00.152666 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 19:29:59.312218 => 19:30:00.152466
[0m19:30:00.153632 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: ROLLBACK
[0m19:30:00.154502 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: ROLLBACK
[0m19:30:00.155352 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: Close
[0m19:30:00.156187 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: Close
[0m19:30:00.157577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e49740730>]}
[0m19:30:00.158832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40e9d2e-a8b0-45ff-acfb-fdaf292be66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4973ab30>]}
[0m19:30:00.159878 [info ] [Thread-4 (]: 3 of 4 OK created sql table model default_marts.sales_by_category .............. [[32mSUCCESS[0m in 0.89s]
[0m19:30:00.160890 [info ] [Thread-3 (]: 4 of 4 OK created sql table model default_marts.sales_by_product ............... [[32mSUCCESS[0m in 0.89s]
[0m19:30:00.161855 [debug] [Thread-4 (]: Finished running node model.iceberg_example.sales_by_category
[0m19:30:00.162855 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m19:30:00.165352 [debug] [MainThread]: On master: COMMIT
[0m19:30:00.166369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:00.167168 [debug] [MainThread]: Connection 'model.iceberg_example.stg_products' was properly closed.
[0m19:30:00.167933 [debug] [MainThread]: Connection 'model.iceberg_example.stg_sales' was properly closed.
[0m19:30:00.168690 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_category' was properly closed.
[0m19:30:00.169438 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_product' was properly closed.
[0m19:30:00.170228 [info ] [MainThread]: 
[0m19:30:00.171111 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m19:30:00.172474 [debug] [MainThread]: Command end result
[0m19:30:00.190251 [info ] [MainThread]: 
[0m19:30:00.191244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:00.192135 [info ] [MainThread]: 
[0m19:30:00.193004 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:30:00.194206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6100497, "process_user_time": 3.735656, "process_kernel_time": 0.238215, "process_mem_max_rss": "168188", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:30:00.195110 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:00.194973 after 2.61 seconds
[0m19:30:00.195891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ebb50c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8f3f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb8c37520>]}
[0m19:30:00.196691 [debug] [MainThread]: Flushing usage events
[0m19:32:08.032689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e36bcfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e346fafb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e346faf50>]}


============================== 19:32:08.038033 | 51009fcd-3fc7-4365-9c82-07cc0dca7789 ==============================
[0m19:32:08.038033 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:32:08.039150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m19:32:08.213055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e34830af0>]}
[0m19:32:08.287206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e343ae170>]}
[0m19:32:08.288457 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:32:08.299100 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:32:08.441392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:32:08.442445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:32:08.448731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e341d40d0>]}
[0m19:32:08.456846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e342ac7f0>]}
[0m19:32:08.457738 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m19:32:08.458616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e342ac7c0>]}
[0m19:32:08.461419 [info ] [MainThread]: 
[0m19:32:08.462561 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:32:08.464414 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_staging'
[0m19:32:08.465450 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_marts'
[0m19:32:08.481699 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m19:32:08.486100 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m19:32:08.487067 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m19:32:08.487920 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m19:32:08.488814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:08.489663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:08.551308 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:32:08.552108 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:32:08.553942 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m19:32:08.555834 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m19:32:08.556832 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m19:32:08.557795 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m19:32:08.561523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51009fcd-3fc7-4365-9c82-07cc0dca7789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e342ac520>]}
[0m19:32:08.562881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:32:08.563876 [info ] [MainThread]: 
[0m19:32:08.570309 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m19:32:08.570815 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m19:32:08.571956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_products)
[0m19:32:08.573271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_sales)
[0m19:32:08.574227 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m19:32:08.575169 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m19:32:08.577721 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m19:32:08.580396 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m19:32:08.584935 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 19:32:08.575915 => 19:32:08.584605
[0m19:32:08.585901 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m19:32:08.586490 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 19:32:08.578539 => 19:32:08.586237
[0m19:32:08.587303 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 19:32:08.587058 => 19:32:08.587074
[0m19:32:08.588226 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m19:32:08.589780 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m19:32:08.590862 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 19:32:08.590579 => 19:32:08.590592
[0m19:32:08.592420 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m19:32:08.592926 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m19:32:08.593444 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m19:32:08.594359 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m19:32:08.595590 [debug] [Thread-4 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_category.6007d8b2d1'
[0m19:32:08.596830 [debug] [Thread-3 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_created_date.db1f142e72'
[0m19:32:08.597931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_products, now test.iceberg_example.not_null_stg_products_price.2d147627d4)
[0m19:32:08.598942 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m19:32:08.600114 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m19:32:08.601058 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m19:32:08.601952 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m19:32:08.603049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_sales, now test.iceberg_example.not_null_stg_products_product_id.6373b0acf3)
[0m19:32:08.615323 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_category.6007d8b2d1"
[0m19:32:08.619499 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_created_date.db1f142e72"
[0m19:32:08.623883 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_price.2d147627d4"
[0m19:32:08.625150 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m19:32:08.631005 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_id.6373b0acf3"
[0m19:32:08.635025 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (compile): 19:32:08.615809 => 19:32:08.634758
[0m19:32:08.635946 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (compile): 19:32:08.620387 => 19:32:08.635696
[0m19:32:08.636685 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m19:32:08.637264 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (compile): 19:32:08.627295 => 19:32:08.637011
[0m19:32:08.637747 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (compile): 19:32:08.603823 => 19:32:08.637521
[0m19:32:08.638491 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m19:32:08.639507 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (execute): 19:32:08.639279 => 19:32:08.639293
[0m19:32:08.640360 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m19:32:08.641226 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m19:32:08.642149 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (execute): 19:32:08.641891 => 19:32:08.641902
[0m19:32:08.643463 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m19:32:08.644360 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (execute): 19:32:08.644145 => 19:32:08.644155
[0m19:32:08.645251 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (execute): 19:32:08.645037 => 19:32:08.645046
[0m19:32:08.646480 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m19:32:08.647356 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m19:32:08.648641 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m19:32:08.650138 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m19:32:08.651236 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m19:32:08.652520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_created_date.db1f142e72, now test.iceberg_example.not_null_stg_products_product_name.0b59e4b939)
[0m19:32:08.653507 [debug] [Thread-2 (]: Began running node model.iceberg_example.sales_by_category
[0m19:32:08.654490 [debug] [Thread-4 (]: Began running node model.iceberg_example.sales_by_product
[0m19:32:08.655664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_price.2d147627d4, now test.iceberg_example.unique_stg_products_product_id.7d950a1467)
[0m19:32:08.656512 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m19:32:08.657708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_id.6373b0acf3, now model.iceberg_example.sales_by_category)
[0m19:32:08.658795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_category.6007d8b2d1, now model.iceberg_example.sales_by_product)
[0m19:32:08.659677 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m19:32:08.664326 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_name.0b59e4b939"
[0m19:32:08.665294 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.sales_by_category
[0m19:32:08.666334 [debug] [Thread-4 (]: Began compiling node model.iceberg_example.sales_by_product
[0m19:32:08.672453 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_products_product_id.7d950a1467"
[0m19:32:08.675863 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m19:32:08.679962 [debug] [Thread-4 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m19:32:08.681287 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (compile): 19:32:08.660357 => 19:32:08.680928
[0m19:32:08.683140 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m19:32:08.684118 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (execute): 19:32:08.683866 => 19:32:08.683878
[0m19:32:08.685708 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m19:32:08.686292 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (compile): 19:32:08.667034 => 19:32:08.686028
[0m19:32:08.686884 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_product (compile): 19:32:08.676549 => 19:32:08.686624
[0m19:32:08.687615 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m19:32:08.688249 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (compile): 19:32:08.673487 => 19:32:08.688001
[0m19:32:08.688938 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m19:32:08.689848 [debug] [Thread-4 (]: Began executing node model.iceberg_example.sales_by_product
[0m19:32:08.690953 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_name.0b59e4b939, now test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276)
[0m19:32:08.691771 [debug] [Thread-2 (]: Began executing node model.iceberg_example.sales_by_category
[0m19:32:08.692654 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (execute): 19:32:08.692430 => 19:32:08.692440
[0m19:32:08.693510 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_product (execute): 19:32:08.693290 => 19:32:08.693300
[0m19:32:08.694307 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m19:32:08.695173 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (execute): 19:32:08.694954 => 19:32:08.694961
[0m19:32:08.696582 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m19:32:08.697861 [debug] [Thread-4 (]: Finished running node model.iceberg_example.sales_by_product
[0m19:32:08.702493 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276"
[0m19:32:08.703767 [debug] [Thread-2 (]: Finished running node model.iceberg_example.sales_by_category
[0m19:32:08.704657 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m19:32:08.705565 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m19:32:08.707136 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m19:32:08.708440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_products_product_id.7d950a1467, now test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12)
[0m19:32:08.709628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_product, now test.iceberg_example.not_null_stg_sales_sale_date.b84165df57)
[0m19:32:08.710685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_category, now test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929)
[0m19:32:08.711729 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m19:32:08.712749 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m19:32:08.713306 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (compile): 19:32:08.698568 => 19:32:08.713076
[0m19:32:08.714007 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m19:32:08.718550 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12"
[0m19:32:08.722886 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_date.b84165df57"
[0m19:32:08.723810 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m19:32:08.728023 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929"
[0m19:32:08.730226 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (execute): 19:32:08.729969 => 19:32:08.729983
[0m19:32:08.732155 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m19:32:08.733358 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m19:32:08.734001 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (compile): 19:32:08.714682 => 19:32:08.733740
[0m19:32:08.734485 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (compile): 19:32:08.724532 => 19:32:08.734260
[0m19:32:08.734945 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (compile): 19:32:08.719285 => 19:32:08.734730
[0m19:32:08.735870 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276, now test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f)
[0m19:32:08.736711 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m19:32:08.737544 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m19:32:08.738376 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m19:32:08.739288 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m19:32:08.740182 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (execute): 19:32:08.739964 => 19:32:08.739974
[0m19:32:08.741042 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (execute): 19:32:08.740831 => 19:32:08.740840
[0m19:32:08.742045 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (execute): 19:32:08.741811 => 19:32:08.741819
[0m19:32:08.746621 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f"
[0m19:32:08.747946 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m19:32:08.749284 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m19:32:08.750508 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m19:32:08.751865 [debug] [Thread-1 (]: Began running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m19:32:08.752752 [debug] [Thread-2 (]: Began running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m19:32:08.753644 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m19:32:08.754782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12, now test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d)
[0m19:32:08.755897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929, now test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521)
[0m19:32:08.757004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_date.b84165df57, now test.iceberg_example.not_null_sales_by_product_category.5dd1b81659)
[0m19:32:08.757688 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (compile): 19:32:08.742748 => 19:32:08.757416
[0m19:32:08.758468 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m19:32:08.759465 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m19:32:08.760337 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m19:32:08.761221 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m19:32:08.769179 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d"
[0m19:32:08.774470 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521"
[0m19:32:08.778846 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_category.5dd1b81659"
[0m19:32:08.779886 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (execute): 19:32:08.779637 => 19:32:08.779649
[0m19:32:08.782604 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m19:32:08.783548 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m19:32:08.784645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f, now test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e)
[0m19:32:08.785468 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m19:32:08.790259 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e"
[0m19:32:08.790801 [debug] [Thread-2 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (compile): 19:32:08.769816 => 19:32:08.790561
[0m19:32:08.791303 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (compile): 19:32:08.775344 => 19:32:08.791084
[0m19:32:08.791762 [debug] [Thread-1 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (compile): 19:32:08.761882 => 19:32:08.791548
[0m19:32:08.792945 [debug] [Thread-2 (]: Began executing node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m19:32:08.793798 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m19:32:08.794623 [debug] [Thread-1 (]: Began executing node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m19:32:08.795499 [debug] [Thread-2 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (execute): 19:32:08.795283 => 19:32:08.795293
[0m19:32:08.796326 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (execute): 19:32:08.796115 => 19:32:08.796122
[0m19:32:08.797224 [debug] [Thread-1 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (execute): 19:32:08.796984 => 19:32:08.796991
[0m19:32:08.797903 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (compile): 19:32:08.786358 => 19:32:08.797694
[0m19:32:08.798900 [debug] [Thread-2 (]: Finished running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m19:32:08.800129 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m19:32:08.801294 [debug] [Thread-1 (]: Finished running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m19:32:08.802072 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m19:32:08.803019 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m19:32:08.804069 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m19:32:08.804998 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m19:32:08.805933 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (execute): 19:32:08.805693 => 19:32:08.805701
[0m19:32:08.807002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521, now test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132)
[0m19:32:08.808014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_category.5dd1b81659, now test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e)
[0m19:32:08.809046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d, now test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371)
[0m19:32:08.810290 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m19:32:08.811123 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m19:32:08.811952 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m19:32:08.812795 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m19:32:08.813756 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m19:32:08.818359 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132"
[0m19:32:08.822760 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e"
[0m19:32:08.826936 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371"
[0m19:32:08.828063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e, now test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710)
[0m19:32:08.830585 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m19:32:08.834904 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710"
[0m19:32:08.836170 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (compile): 19:32:08.814432 => 19:32:08.835826
[0m19:32:08.836760 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (compile): 19:32:08.823474 => 19:32:08.836496
[0m19:32:08.837234 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (compile): 19:32:08.819135 => 19:32:08.837014
[0m19:32:08.837953 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m19:32:08.838813 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m19:32:08.839678 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m19:32:08.840586 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (execute): 19:32:08.840368 => 19:32:08.840378
[0m19:32:08.841137 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (compile): 19:32:08.831280 => 19:32:08.840927
[0m19:32:08.842089 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (execute): 19:32:08.841863 => 19:32:08.841872
[0m19:32:08.843133 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (execute): 19:32:08.842920 => 19:32:08.842928
[0m19:32:08.844376 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m19:32:08.845467 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m19:32:08.846678 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m19:32:08.847834 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m19:32:08.848713 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m19:32:08.849644 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (execute): 19:32:08.849426 => 19:32:08.849435
[0m19:32:08.850506 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m19:32:08.851408 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m19:32:08.852431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132, now test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873)
[0m19:32:08.853645 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m19:32:08.854620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371, now test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6)
[0m19:32:08.855595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e, now test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc)
[0m19:32:08.856411 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m19:32:08.857277 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m19:32:08.858076 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m19:32:08.858899 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m19:32:08.863328 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873"
[0m19:32:08.864444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710, now test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c)
[0m19:32:08.869655 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6"
[0m19:32:08.873560 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc"
[0m19:32:08.874904 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m19:32:08.879557 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c"
[0m19:32:08.880667 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (compile): 19:32:08.870319 => 19:32:08.880451
[0m19:32:08.881112 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (compile): 19:32:08.859608 => 19:32:08.880903
[0m19:32:08.881550 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (compile): 19:32:08.865102 => 19:32:08.881347
[0m19:32:08.882230 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m19:32:08.883037 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m19:32:08.883766 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m19:32:08.884716 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (execute): 19:32:08.884504 => 19:32:08.884513
[0m19:32:08.885365 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (compile): 19:32:08.876444 => 19:32:08.885162
[0m19:32:08.885979 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (execute): 19:32:08.885733 => 19:32:08.885740
[0m19:32:08.886831 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (execute): 19:32:08.886627 => 19:32:08.886634
[0m19:32:08.887985 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m19:32:08.888774 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m19:32:08.890043 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m19:32:08.891189 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m19:32:08.892009 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m19:32:08.892873 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (execute): 19:32:08.892662 => 19:32:08.892668
[0m19:32:08.893689 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m19:32:08.894571 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m19:32:08.895621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc, now test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8)
[0m19:32:08.896797 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m19:32:08.897769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873, now test.iceberg_example.not_null_sales_by_category_category.99acef3343)
[0m19:32:08.898759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6, now test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad)
[0m19:32:08.899667 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m19:32:08.900581 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m19:32:08.901374 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m19:32:08.902154 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m19:32:08.906335 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8"
[0m19:32:08.907389 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c, now test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d)
[0m19:32:08.911357 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_category.99acef3343"
[0m19:32:08.915129 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad"
[0m19:32:08.916386 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m19:32:08.921163 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d"
[0m19:32:08.922312 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (compile): 19:32:08.902865 => 19:32:08.922096
[0m19:32:08.922756 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (compile): 19:32:08.912050 => 19:32:08.922546
[0m19:32:08.923195 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (compile): 19:32:08.908031 => 19:32:08.922988
[0m19:32:08.923887 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m19:32:08.924708 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m19:32:08.925519 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m19:32:08.926438 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (execute): 19:32:08.926226 => 19:32:08.926235
[0m19:32:08.926959 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (compile): 19:32:08.917972 => 19:32:08.926754
[0m19:32:08.927679 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (execute): 19:32:08.927466 => 19:32:08.927474
[0m19:32:08.928551 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (execute): 19:32:08.928334 => 19:32:08.928341
[0m19:32:08.929925 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m19:32:08.930771 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m19:32:08.931947 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m19:32:08.933104 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m19:32:08.933961 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m19:32:08.934854 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (execute): 19:32:08.934644 => 19:32:08.934651
[0m19:32:08.935679 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m19:32:08.936540 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m19:32:08.937566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8, now test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d)
[0m19:32:08.938811 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m19:32:08.939811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad, now test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87)
[0m19:32:08.940855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_category.99acef3343, now test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd)
[0m19:32:08.941666 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m19:32:08.942526 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m19:32:08.943342 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m19:32:08.944180 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m19:32:08.949779 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d"
[0m19:32:08.950634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d, now test.iceberg_example.unique_sales_by_category_category.b77939e04a)
[0m19:32:08.954390 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87"
[0m19:32:08.958334 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd"
[0m19:32:08.959695 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m19:32:08.964324 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_category_category.b77939e04a"
[0m19:32:08.965561 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (compile): 19:32:08.951283 => 19:32:08.965344
[0m19:32:08.966033 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (compile): 19:32:08.955086 => 19:32:08.965823
[0m19:32:08.966497 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (compile): 19:32:08.944861 => 19:32:08.966262
[0m19:32:08.967158 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m19:32:08.967971 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m19:32:08.968844 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m19:32:08.969431 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (compile): 19:32:08.961277 => 19:32:08.969221
[0m19:32:08.970139 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (execute): 19:32:08.969926 => 19:32:08.969934
[0m19:32:08.971272 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (execute): 19:32:08.970916 => 19:32:08.970926
[0m19:32:08.972196 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (execute): 19:32:08.971972 => 19:32:08.971979
[0m19:32:08.972978 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m19:32:08.974169 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m19:32:08.975282 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m19:32:08.976424 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m19:32:08.977289 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (execute): 19:32:08.977077 => 19:32:08.977084
[0m19:32:08.979986 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m19:32:08.981564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:08.982287 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd' was properly closed.
[0m19:32:08.983025 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87' was properly closed.
[0m19:32:08.983763 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d' was properly closed.
[0m19:32:08.984468 [debug] [MainThread]: Connection 'test.iceberg_example.unique_sales_by_category_category.b77939e04a' was properly closed.
[0m19:32:08.988082 [debug] [MainThread]: Command end result
[0m19:30:59.169194 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m19:30:59.170072 [info ] [MainThread]: Building catalog
[0m19:30:59.172061 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m19:30:59.197182 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m19:30:59.198097 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_category'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_product'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_products'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_sales'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m19:30:59.198956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:10.004212 [debug] [ThreadPool]: SQL status: SUCCESS in 71.0 seconds
[0m19:32:10.010887 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m19:32:10.031356 [info ] [MainThread]: Catalog written to /opt/airflow/dbt_project/target/catalog.json
[0m19:32:10.032997 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2742194, "process_user_time": 2.819633, "process_kernel_time": 0.260273, "process_mem_max_rss": "168204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:32:10.034145 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:32:10.033975 after 1.28 seconds
[0m19:32:10.035017 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:32:10.035832 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m19:32:10.036706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e36bcfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e345ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e342ac5b0>]}
[0m19:32:10.037607 [debug] [MainThread]: Flushing usage events
[0m09:50:36.637384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f004e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3fbc2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f0052d0>]}


============================== 09:50:36.650779 | 0a5c3ab3-cb38-48f6-85b4-b7015c702463 ==============================
[0m09:50:36.650779 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:50:36.651698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:36.652979 [info ] [MainThread]: dbt version: 1.7.0
[0m09:50:36.653712 [info ] [MainThread]: python version: 3.11.9
[0m09:50:36.654424 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:50:36.655128 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m09:50:36.731720 [info ] [MainThread]: Using profiles dir at .
[0m09:50:36.732784 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m09:50:36.733552 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt_project/dbt_project.yml
[0m09:50:36.734317 [info ] [MainThread]: adapter type: trino
[0m09:50:36.735007 [info ] [MainThread]: adapter version: 1.7.0
[0m09:50:36.784136 [info ] [MainThread]: Configuration:
[0m09:50:36.785083 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:50:36.785826 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:50:36.786526 [info ] [MainThread]: Required dependencies:
[0m09:50:36.787270 [debug] [MainThread]: Executing "git --help"
[0m09:50:36.789718 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:50:36.790389 [debug] [MainThread]: STDERR: "b''"
[0m09:50:36.791038 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:50:36.791711 [info ] [MainThread]: Connection:
[0m09:50:36.792434 [info ] [MainThread]:   host: trino
[0m09:50:36.793123 [info ] [MainThread]:   port: 8080
[0m09:50:36.793817 [info ] [MainThread]:   user: airflow
[0m09:50:36.794535 [info ] [MainThread]:   database: iceberg
[0m09:50:36.795241 [info ] [MainThread]:   schema: default
[0m09:50:36.796056 [info ] [MainThread]:   cert: None
[0m09:50:36.796787 [info ] [MainThread]:   prepared_statements_enabled: True
[0m09:50:36.797538 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:50:36.798415 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m09:50:36.801966 [debug] [MainThread]: Using trino connection "debug"
[0m09:50:36.802730 [debug] [MainThread]: On debug: select 1 as id
[0m09:50:36.803392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:36.843755 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:36.845113 [debug] [MainThread]: On debug: Close
[0m09:50:36.845917 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:50:36.846664 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:50:36.847724 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.24581057, "process_user_time": 1.893393, "process_kernel_time": 0.226753, "process_mem_max_rss": "187560", "process_in_blocks": "10104", "process_out_blocks": "4152"}
[0m09:50:36.848530 [debug] [MainThread]: Command `dbt debug` succeeded at 09:50:36.848413 after 0.25 seconds
[0m09:50:36.849212 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:50:36.849921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3eda0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f04ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3f049850>]}
[0m09:50:36.850640 [debug] [MainThread]: Flushing usage events
[0m09:50:40.487957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750fee410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3751607050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37514d9cd0>]}


============================== 09:50:40.492401 | 3f192f06-7459-478f-b671-78f8e43a2342 ==============================
[0m09:50:40.492401 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:50:40.493315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:40.638661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750fed510>]}
[0m09:50:40.695494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3751607250>]}
[0m09:50:40.696620 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:50:40.706292 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m09:50:40.812807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:40.813748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:40.819073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750be0d90>]}
[0m09:50:40.839374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750d3fb50>]}
[0m09:50:40.840203 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m09:50:40.840943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750ab16d0>]}
[0m09:50:40.843009 [info ] [MainThread]: 
[0m09:50:40.844136 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:50:40.845587 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m09:50:40.846386 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m09:50:40.858572 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:50:40.860945 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:50:40.861754 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:50:40.862548 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:50:40.863247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:40.863929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:40.930238 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:40.931179 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:40.932740 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:50:40.934027 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:50:40.936372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_default_marts)
[0m09:50:40.936951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_default_staging)
[0m09:50:40.937848 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "default_marts"
"
[0m09:50:40.938881 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "default_staging"
"
[0m09:50:40.943197 [debug] [ThreadPool]: Using trino connection "create_iceberg_default_marts"
[0m09:50:40.945425 [debug] [ThreadPool]: Using trino connection "create_iceberg_default_staging"
[0m09:50:40.946193 [debug] [ThreadPool]: On create_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "create_iceberg_default_marts"} */
create schema if not exists "iceberg"."default_marts"
[0m09:50:40.946907 [debug] [ThreadPool]: On create_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "create_iceberg_default_staging"} */
create schema if not exists "iceberg"."default_staging"
[0m09:50:40.947618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:40.948329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:40.991677 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:40.992422 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:40.993437 [debug] [ThreadPool]: On create_iceberg_default_marts: COMMIT
[0m09:50:40.994632 [debug] [ThreadPool]: On create_iceberg_default_staging: COMMIT
[0m09:50:40.995369 [debug] [ThreadPool]: On create_iceberg_default_marts: Close
[0m09:50:40.996126 [debug] [ThreadPool]: On create_iceberg_default_staging: Close
[0m09:50:40.999529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_default_staging, now list_iceberg_default_marts)
[0m09:50:41.000188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_default_marts, now list_iceberg_default_staging)
[0m09:50:41.006546 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m09:50:41.056864 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m09:50:41.057587 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m09:50:41.058395 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m09:50:41.059172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:41.059893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:52.214347 [debug] [ThreadPool]: SQL status: SUCCESS in 11.0 seconds
[0m09:50:52.215019 [debug] [ThreadPool]: SQL status: SUCCESS in 11.0 seconds
[0m09:50:52.216552 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m09:50:52.218361 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m09:50:52.219324 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m09:50:52.220155 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m09:50:52.222489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3751c5ad10>]}
[0m09:50:52.223443 [debug] [MainThread]: On master: COMMIT
[0m09:50:52.224513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:52.225396 [info ] [MainThread]: 
[0m09:50:52.232165 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m09:50:52.232679 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m09:50:52.233612 [info ] [Thread-1 (]: 1 of 4 START sql view model default_staging.stg_products ....................... [RUN]
[0m09:50:52.234554 [info ] [Thread-2 (]: 2 of 4 START sql view model default_staging.stg_sales .......................... [RUN]
[0m09:50:52.235719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_products)
[0m09:50:52.236892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_sales)
[0m09:50:52.237743 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m09:50:52.238602 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m09:50:52.240834 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m09:50:52.243196 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m09:50:52.248156 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 09:50:52.239251 => 09:50:52.247832
[0m09:50:52.249160 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m09:50:52.249633 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 09:50:52.241665 => 09:50:52.249423
[0m09:50:52.267836 [debug] [Thread-1 (]: Writing runtime sql for node "model.iceberg_example.stg_products"
[0m09:50:52.268362 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m09:50:52.272246 [debug] [Thread-2 (]: Writing runtime sql for node "model.iceberg_example.stg_sales"
[0m09:50:52.276150 [debug] [Thread-1 (]: Using trino connection "model.iceberg_example.stg_products"
[0m09:50:52.277072 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_products"} */

  create or replace view
    "iceberg"."default_staging"."stg_products"
  security definer
  as
    with source as (
    select * from iceberg.raw.products
),

renamed as (
    select
        id as product_id,
        name as product_name,
        category,
        price,
        date as created_date
    from source
)

select * from renamed
  
[0m09:50:52.278244 [debug] [Thread-2 (]: Using trino connection "model.iceberg_example.stg_sales"
[0m09:50:52.278915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:52.279811 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_sales"} */

  create or replace view
    "iceberg"."default_staging"."stg_sales"
  security definer
  as
    with source as (
    select * from iceberg.raw.sales
),

renamed as (
    select
        sale_id,
        product_id,
        quantity,
        total as total_amount,
        date as sale_date
    from source
)

select * from renamed
  
[0m09:50:52.282051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:50:52.345132 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:52.346026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:52.359281 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 09:50:52.269650 => 09:50:52.359085
[0m09:50:52.362126 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 09:50:52.250098 => 09:50:52.361880
[0m09:50:52.363249 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: ROLLBACK
[0m09:50:52.364231 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: ROLLBACK
[0m09:50:52.365018 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: Close
[0m09:50:52.365960 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: Close
[0m09:50:52.367288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750d61250>]}
[0m09:50:52.368376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750bf9c10>]}
[0m09:50:52.369282 [info ] [Thread-2 (]: 2 of 4 OK created sql view model default_staging.stg_sales ..................... [[32mSUCCESS[0m in 0.13s]
[0m09:50:52.370273 [info ] [Thread-1 (]: 1 of 4 OK created sql view model default_staging.stg_products .................. [[32mSUCCESS[0m in 0.13s]
[0m09:50:52.371240 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m09:50:52.372177 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m09:50:52.373994 [debug] [Thread-4 (]: Began running node model.iceberg_example.sales_by_category
[0m09:50:52.374493 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m09:50:52.375255 [info ] [Thread-4 (]: 3 of 4 START sql table model default_marts.sales_by_category ................... [RUN]
[0m09:50:52.376181 [info ] [Thread-3 (]: 4 of 4 START sql table model default_marts.sales_by_product .................... [RUN]
[0m09:50:52.377407 [debug] [Thread-4 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_category'
[0m09:50:52.378542 [debug] [Thread-3 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_product'
[0m09:50:52.379399 [debug] [Thread-4 (]: Began compiling node model.iceberg_example.sales_by_category
[0m09:50:52.380226 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m09:50:52.383800 [debug] [Thread-4 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m09:50:52.387211 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m09:50:52.393159 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (compile): 09:50:52.380916 => 09:50:52.392889
[0m09:50:52.393995 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 09:50:52.384698 => 09:50:52.393784
[0m09:50:52.394641 [debug] [Thread-4 (]: Began executing node model.iceberg_example.sales_by_category
[0m09:50:52.395919 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m09:50:52.433239 [debug] [Thread-3 (]: Writing runtime sql for node "model.iceberg_example.sales_by_product"
[0m09:50:52.433963 [debug] [Thread-4 (]: Writing runtime sql for node "model.iceberg_example.sales_by_category"
[0m09:50:52.439919 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:50:52.440754 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

  
    

    create table "iceberg"."default_marts"."sales_by_product__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_product as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price as unit_price,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date,
        count(distinct s.sale_id) as number_of_sales
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1, 2, 3, 4
)

select * from sales_by_product
    )
[0m09:50:52.442870 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:50:52.443538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:50:52.444473 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

  
    

    create table "iceberg"."default_marts"."sales_by_category__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_category as (
    select
        p.category,
        count(distinct p.product_id) as number_of_products,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        avg(s.total_amount / s.quantity) as average_unit_price,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1
)

select * from sales_by_category
    )
[0m09:50:52.446859 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:50:53.105014 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.0 seconds
[0m09:50:53.111256 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:50:53.112388 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_category"
[0m09:50:53.128749 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.0 seconds
[0m09:50:53.132939 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:50:53.133953 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_product"
[0m09:50:53.160723 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:53.167785 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m09:50:53.171495 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:50:53.172317 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:53.172913 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

    drop table if exists "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m09:50:53.176378 [debug] [Thread-3 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m09:50:53.179222 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:50:53.180197 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

    drop table if exists "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m09:50:53.189103 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:53.192764 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (execute): 09:50:52.396758 => 09:50:53.192524
[0m09:50:53.193532 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:53.194520 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: ROLLBACK
[0m09:50:53.197320 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 09:50:52.418269 => 09:50:53.197089
[0m09:50:53.198330 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: Close
[0m09:50:53.199220 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: ROLLBACK
[0m09:50:53.200545 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750e300d0>]}
[0m09:50:53.201268 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: Close
[0m09:50:53.202295 [info ] [Thread-4 (]: 3 of 4 OK created sql table model default_marts.sales_by_category .............. [[32mSUCCESS[0m in 0.82s]
[0m09:50:53.203621 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f192f06-7459-478f-b671-78f8e43a2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3750c3d810>]}
[0m09:50:53.204469 [debug] [Thread-4 (]: Finished running node model.iceberg_example.sales_by_category
[0m09:50:53.205468 [info ] [Thread-3 (]: 4 of 4 OK created sql table model default_marts.sales_by_product ............... [[32mSUCCESS[0m in 0.83s]
[0m09:50:53.207097 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m09:50:53.209409 [debug] [MainThread]: On master: COMMIT
[0m09:50:53.210415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:53.211161 [debug] [MainThread]: Connection 'model.iceberg_example.stg_products' was properly closed.
[0m09:50:53.211918 [debug] [MainThread]: Connection 'model.iceberg_example.stg_sales' was properly closed.
[0m09:50:53.212645 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_category' was properly closed.
[0m09:50:53.213383 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_product' was properly closed.
[0m09:50:53.214171 [info ] [MainThread]: 
[0m09:50:53.214977 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 12.37 seconds (12.37s).
[0m09:50:53.216258 [debug] [MainThread]: Command end result
[0m09:50:53.233473 [info ] [MainThread]: 
[0m09:50:53.234352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:50:53.235151 [info ] [MainThread]: 
[0m09:50:53.236027 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:50:53.237222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.920157, "process_user_time": 2.343891, "process_kernel_time": 0.16202, "process_mem_max_rss": "187560", "process_in_blocks": "96", "process_out_blocks": "0"}
[0m09:50:53.238144 [debug] [MainThread]: Command `dbt run` succeeded at 09:50:53.238016 after 11.92 seconds
[0m09:50:53.238961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375583ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37557bc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37556fb690>]}
[0m09:50:53.239790 [debug] [MainThread]: Flushing usage events
[0m09:50:56.614821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9a42610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9a88fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9a8a910>]}


============================== 09:50:56.619994 | 4e09a722-6037-4db9-bf4c-579fe5590d18 ==============================
[0m09:50:56.619994 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:50:56.620959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m09:50:56.768323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9807a50>]}
[0m09:50:56.827258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9958e50>]}
[0m09:50:56.828559 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:50:56.837854 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m09:50:56.933715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:56.934611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:56.940464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9a896d0>]}
[0m09:50:56.948194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd97e8b10>]}
[0m09:50:56.949018 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m09:50:56.949823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd96456d0>]}
[0m09:50:56.952234 [info ] [MainThread]: 
[0m09:50:56.953337 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:50:56.954910 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_marts'
[0m09:50:56.955838 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_staging'
[0m09:50:56.969589 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m09:50:56.973117 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m09:50:56.973980 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m09:50:56.974749 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m09:50:56.975504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:56.976284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:57.072651 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:57.073371 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:57.075000 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m09:50:57.076558 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m09:50:57.077325 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m09:50:57.078138 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m09:50:57.080999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e09a722-6037-4db9-bf4c-579fe5590d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fda67f010>]}
[0m09:50:57.082130 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:57.082948 [info ] [MainThread]: 
[0m09:50:57.090593 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m09:50:57.091033 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m09:50:57.092075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_products)
[0m09:50:57.093157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_sales)
[0m09:50:57.094085 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m09:50:57.094939 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m09:50:57.097359 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m09:50:57.099294 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m09:50:57.103827 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 09:50:57.095648 => 09:50:57.103596
[0m09:50:57.104671 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m09:50:57.105096 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 09:50:57.098077 => 09:50:57.104899
[0m09:50:57.105880 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 09:50:57.105607 => 09:50:57.105653
[0m09:50:57.106665 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m09:50:57.107906 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m09:50:57.108711 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 09:50:57.108521 => 09:50:57.108527
[0m09:50:57.109981 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:50:57.110404 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:50:57.110836 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:50:57.111614 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m09:50:57.112646 [debug] [Thread-4 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_category.6007d8b2d1'
[0m09:50:57.113836 [debug] [Thread-3 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_created_date.db1f142e72'
[0m09:50:57.114816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_products, now test.iceberg_example.not_null_stg_products_price.2d147627d4)
[0m09:50:57.115684 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:50:57.116607 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:50:57.117399 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:50:57.118168 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:50:57.119168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_sales, now test.iceberg_example.not_null_stg_products_product_id.6373b0acf3)
[0m09:50:57.128892 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_category.6007d8b2d1"
[0m09:50:57.132626 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_created_date.db1f142e72"
[0m09:50:57.136467 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_price.2d147627d4"
[0m09:50:57.137296 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:50:57.143674 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_id.6373b0acf3"
[0m09:50:57.147721 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (compile): 09:50:57.119754 => 09:50:57.147382
[0m09:50:57.148443 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (compile): 09:50:57.133424 => 09:50:57.148248
[0m09:50:57.149123 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:50:57.149717 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (compile): 09:50:57.139302 => 09:50:57.149523
[0m09:50:57.150132 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (compile): 09:50:57.129452 => 09:50:57.149940
[0m09:50:57.150793 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:50:57.151569 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (execute): 09:50:57.151369 => 09:50:57.151382
[0m09:50:57.152357 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:50:57.153183 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:50:57.154026 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (execute): 09:50:57.153837 => 09:50:57.153843
[0m09:50:57.155160 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:50:57.156020 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (execute): 09:50:57.155833 => 09:50:57.155840
[0m09:50:57.156823 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (execute): 09:50:57.156639 => 09:50:57.156645
[0m09:50:57.158055 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:50:57.158811 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:50:57.160013 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:50:57.161315 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:50:57.162210 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:50:57.163157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_category.6007d8b2d1, now test.iceberg_example.not_null_stg_products_product_name.0b59e4b939)
[0m09:50:57.164044 [debug] [Thread-2 (]: Began running node model.iceberg_example.sales_by_category
[0m09:50:57.164909 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m09:50:57.165967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_price.2d147627d4, now test.iceberg_example.unique_stg_products_product_id.7d950a1467)
[0m09:50:57.166661 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:50:57.167666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_id.6373b0acf3, now model.iceberg_example.sales_by_category)
[0m09:50:57.168822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_created_date.db1f142e72, now model.iceberg_example.sales_by_product)
[0m09:50:57.169802 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:50:57.232222 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_name.0b59e4b939"
[0m09:50:57.233169 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.sales_by_category
[0m09:50:57.234123 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m09:50:57.240636 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_products_product_id.7d950a1467"
[0m09:50:57.244067 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m09:50:57.247113 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m09:50:57.248394 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (compile): 09:50:57.170556 => 09:50:57.248028
[0m09:50:57.250091 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:50:57.251320 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (execute): 09:50:57.250931 => 09:50:57.250942
[0m09:50:57.252819 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:50:57.253253 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (compile): 09:50:57.241711 => 09:50:57.253061
[0m09:50:57.253651 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (compile): 09:50:57.234903 => 09:50:57.253457
[0m09:50:57.254097 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 09:50:57.244778 => 09:50:57.253891
[0m09:50:57.254639 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:50:57.255451 [debug] [Thread-2 (]: Began executing node model.iceberg_example.sales_by_category
[0m09:50:57.256285 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:50:57.257111 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m09:50:57.258349 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_name.0b59e4b939, now test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276)
[0m09:50:57.259412 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (execute): 09:50:57.259179 => 09:50:57.259198
[0m09:50:57.260296 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (execute): 09:50:57.260088 => 09:50:57.260093
[0m09:50:57.261124 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 09:50:57.260939 => 09:50:57.260944
[0m09:50:57.261933 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:50:57.263143 [debug] [Thread-2 (]: Finished running node model.iceberg_example.sales_by_category
[0m09:50:57.264305 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:50:57.265490 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m09:50:57.269678 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276"
[0m09:50:57.270564 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:50:57.271672 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:50:57.272536 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:50:57.274193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_category, now test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12)
[0m09:50:57.275178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_products_product_id.7d950a1467, now test.iceberg_example.not_null_stg_sales_sale_date.b84165df57)
[0m09:50:57.276202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_product, now test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929)
[0m09:50:57.277014 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:50:57.277944 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:50:57.279007 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:50:57.283175 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12"
[0m09:50:57.283651 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (compile): 09:50:57.266204 => 09:50:57.283444
[0m09:50:57.287365 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_date.b84165df57"
[0m09:50:57.291162 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929"
[0m09:50:57.292581 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:50:57.294585 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (execute): 09:50:57.294379 => 09:50:57.294388
[0m09:50:57.295852 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:50:57.296456 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (compile): 09:50:57.279794 => 09:50:57.296203
[0m09:50:57.297240 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (compile): 09:50:57.288080 => 09:50:57.297023
[0m09:50:57.297677 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:50:57.298189 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (compile): 09:50:57.284170 => 09:50:57.297995
[0m09:50:57.298835 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:50:57.299596 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:50:57.300592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276, now test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f)
[0m09:50:57.301371 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:50:57.302228 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (execute): 09:50:57.302035 => 09:50:57.302040
[0m09:50:57.303067 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (execute): 09:50:57.302877 => 09:50:57.302882
[0m09:50:57.303829 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:50:57.304662 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (execute): 09:50:57.304476 => 09:50:57.304481
[0m09:50:57.305909 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:50:57.307076 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:50:57.310860 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f"
[0m09:50:57.312015 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:50:57.312865 [debug] [Thread-2 (]: Began running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:50:57.313697 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:50:57.314984 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:50:57.316022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12, now test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d)
[0m09:50:57.317025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929, now test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521)
[0m09:50:57.318000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_date.b84165df57, now test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8)
[0m09:50:57.318785 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:50:57.319590 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:50:57.320286 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (compile): 09:50:57.307707 => 09:50:57.320094
[0m09:50:57.320764 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:50:57.327423 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d"
[0m09:50:57.330896 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521"
[0m09:50:57.331679 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:50:57.336635 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8"
[0m09:50:57.338446 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (execute): 09:50:57.338255 => 09:50:57.338261
[0m09:50:57.340124 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:50:57.341147 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:50:57.341606 [debug] [Thread-2 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (compile): 09:50:57.321421 => 09:50:57.341414
[0m09:50:57.342445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f, now test.iceberg_example.not_null_sales_by_category_category.99acef3343)
[0m09:50:57.342898 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (compile): 09:50:57.327970 => 09:50:57.342709
[0m09:50:57.343541 [debug] [Thread-2 (]: Began executing node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:50:57.343978 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (compile): 09:50:57.332330 => 09:50:57.343787
[0m09:50:57.344606 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:50:57.345392 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:50:57.346344 [debug] [Thread-2 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (execute): 09:50:57.346155 => 09:50:57.346160
[0m09:50:57.347107 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:50:57.350783 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_category.99acef3343"
[0m09:50:57.351840 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (execute): 09:50:57.351579 => 09:50:57.351586
[0m09:50:57.352981 [debug] [Thread-2 (]: Finished running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:50:57.353800 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (execute): 09:50:57.353609 => 09:50:57.353614
[0m09:50:57.355397 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:50:57.356291 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:50:57.357475 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:50:57.358298 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:50:57.359328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d, now test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad)
[0m09:50:57.360207 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:50:57.360817 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (compile): 09:50:57.347745 => 09:50:57.360628
[0m09:50:57.361518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521, now test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d)
[0m09:50:57.362291 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:50:57.363262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8, now test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d)
[0m09:50:57.364015 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:50:57.364791 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:50:57.368592 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad"
[0m09:50:57.369383 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:50:57.370230 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (execute): 09:50:57.370038 => 09:50:57.370044
[0m09:50:57.373839 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d"
[0m09:50:57.378281 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d"
[0m09:50:57.379520 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:50:57.381405 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:50:57.382553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_category.99acef3343, now test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87)
[0m09:50:57.382978 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (compile): 09:50:57.365415 => 09:50:57.382775
[0m09:50:57.383384 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (compile): 09:50:57.370862 => 09:50:57.383189
[0m09:50:57.383825 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (compile): 09:50:57.375126 => 09:50:57.383627
[0m09:50:57.384320 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:50:57.385139 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:50:57.385957 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:50:57.386757 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:50:57.390620 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87"
[0m09:50:57.391547 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (execute): 09:50:57.391352 => 09:50:57.391358
[0m09:50:57.392474 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (execute): 09:50:57.392280 => 09:50:57.392286
[0m09:50:57.393324 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (execute): 09:50:57.393130 => 09:50:57.393136
[0m09:50:57.395046 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:50:57.396212 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:50:57.397414 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:50:57.398285 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:50:57.399153 [debug] [Thread-3 (]: Began running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:50:57.400072 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:50:57.400751 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (compile): 09:50:57.387460 => 09:50:57.400552
[0m09:50:57.401482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad, now test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd)
[0m09:50:57.402506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d, now test.iceberg_example.unique_sales_by_category_category.b77939e04a)
[0m09:50:57.403527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d, now test.iceberg_example.not_null_sales_by_product_category.5dd1b81659)
[0m09:50:57.404352 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:50:57.405136 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:50:57.405941 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:50:57.406754 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:50:57.407602 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (execute): 09:50:57.407408 => 09:50:57.407414
[0m09:50:57.411640 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd"
[0m09:50:57.415409 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_category_category.b77939e04a"
[0m09:50:57.419205 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_category.5dd1b81659"
[0m09:50:57.420399 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:50:57.422767 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:50:57.423808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87, now test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e)
[0m09:50:57.424782 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:50:57.425267 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (compile): 09:50:57.408229 => 09:50:57.425074
[0m09:50:57.428910 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e"
[0m09:50:57.429353 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (compile): 09:50:57.416156 => 09:50:57.429158
[0m09:50:57.429777 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (compile): 09:50:57.412299 => 09:50:57.429588
[0m09:50:57.430409 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:50:57.431695 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:50:57.432496 [debug] [Thread-3 (]: Began executing node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:50:57.433301 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (execute): 09:50:57.433111 => 09:50:57.433117
[0m09:50:57.434154 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (execute): 09:50:57.433967 => 09:50:57.433972
[0m09:50:57.434967 [debug] [Thread-3 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (execute): 09:50:57.434771 => 09:50:57.434776
[0m09:50:57.436131 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:50:57.437300 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:50:57.437716 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (compile): 09:50:57.425796 => 09:50:57.437528
[0m09:50:57.438800 [debug] [Thread-3 (]: Finished running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:50:57.439648 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:50:57.440485 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:50:57.441280 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:50:57.442093 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:50:57.443083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd, now test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132)
[0m09:50:57.444169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_category.5dd1b81659, now test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e)
[0m09:50:57.445015 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (execute): 09:50:57.444823 => 09:50:57.444828
[0m09:50:57.446050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_sales_by_category_category.b77939e04a, now test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371)
[0m09:50:57.446904 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:50:57.447738 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:50:57.449105 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:50:57.449879 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:50:57.453764 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132"
[0m09:50:57.459310 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e"
[0m09:50:57.460224 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:50:57.464144 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371"
[0m09:50:57.467013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e, now test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710)
[0m09:50:57.468312 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:50:57.472119 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710"
[0m09:50:57.473160 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (compile): 09:50:57.450527 => 09:50:57.472925
[0m09:50:57.473856 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (compile): 09:50:57.454428 => 09:50:57.473658
[0m09:50:57.474289 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (compile): 09:50:57.461114 => 09:50:57.474095
[0m09:50:57.474822 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:50:57.475797 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:50:57.476589 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (compile): 09:50:57.469065 => 09:50:57.476376
[0m09:50:57.476963 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:50:57.477845 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (execute): 09:50:57.477655 => 09:50:57.477662
[0m09:50:57.478690 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (execute): 09:50:57.478497 => 09:50:57.478503
[0m09:50:57.479483 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:50:57.480311 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (execute): 09:50:57.480121 => 09:50:57.480126
[0m09:50:57.481465 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:50:57.482622 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:50:57.483474 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (execute): 09:50:57.483263 => 09:50:57.483268
[0m09:50:57.484650 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:50:57.485477 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:50:57.486415 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:50:57.487564 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:50:57.488371 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:50:57.489404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132, now test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873)
[0m09:50:57.490363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e, now test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6)
[0m09:50:57.491189 [debug] [Thread-4 (]: Began running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:50:57.492193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371, now test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc)
[0m09:50:57.492952 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:50:57.493730 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:50:57.494726 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710, now test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c)
[0m09:50:57.495507 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:50:57.499490 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873"
[0m09:50:57.503311 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6"
[0m09:50:57.504128 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:50:57.507931 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc"
[0m09:50:57.512670 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c"
[0m09:50:57.516772 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (compile): 09:50:57.500239 => 09:50:57.516570
[0m09:50:57.517522 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (compile): 09:50:57.496207 => 09:50:57.517324
[0m09:50:57.517983 [debug] [Thread-4 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (compile): 09:50:57.509728 => 09:50:57.517770
[0m09:50:57.518536 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:50:57.519331 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (compile): 09:50:57.504776 => 09:50:57.519138
[0m09:50:57.519689 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:50:57.520474 [debug] [Thread-4 (]: Began executing node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:50:57.521295 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (execute): 09:50:57.521106 => 09:50:57.521112
[0m09:50:57.522040 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:50:57.522901 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (execute): 09:50:57.522713 => 09:50:57.522718
[0m09:50:57.523723 [debug] [Thread-4 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (execute): 09:50:57.523539 => 09:50:57.523545
[0m09:50:57.524845 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:50:57.525691 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (execute): 09:50:57.525464 => 09:50:57.525469
[0m09:50:57.526852 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:50:57.528029 [debug] [Thread-4 (]: Finished running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:50:57.529666 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:50:57.532674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:57.533430 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873' was properly closed.
[0m09:50:57.534158 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6' was properly closed.
[0m09:50:57.534872 [debug] [MainThread]: Connection 'test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c' was properly closed.
[0m09:50:57.535565 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc' was properly closed.
[0m09:50:57.538806 [debug] [MainThread]: Command end result
[0m09:50:57.566734 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m09:50:57.567505 [info ] [MainThread]: Building catalog
[0m09:50:57.569304 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m09:50:57.592175 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m09:50:57.593037 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_products'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_category'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_sales'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_product'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m09:50:57.593933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:57.972409 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:50:57.978244 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m09:50:57.997732 [info ] [MainThread]: Catalog written to /opt/airflow/dbt_project/target/catalog.json
[0m09:50:57.999132 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.4218731, "process_user_time": 2.265604, "process_kernel_time": 0.24309, "process_mem_max_rss": "187564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:58.000119 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:50:57.999981 after 1.42 seconds
[0m09:50:58.000878 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:50:58.001623 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m09:50:58.002407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fda37bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd9cae710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fdb9138d0>]}
[0m09:50:58.003466 [debug] [MainThread]: Flushing usage events
[0m09:52:34.302600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f2211da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f22609c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f236cf950>]}


============================== 09:52:34.307144 | 3545309a-4dcf-47e2-b3d7-00295f1a9420 ==============================
[0m09:52:34.307144 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:52:34.308016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:34.309284 [info ] [MainThread]: dbt version: 1.7.0
[0m09:52:34.310015 [info ] [MainThread]: python version: 3.11.9
[0m09:52:34.310723 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:52:34.311410 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m09:52:34.389355 [info ] [MainThread]: Using profiles dir at .
[0m09:52:34.390315 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m09:52:34.391035 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt_project/dbt_project.yml
[0m09:52:34.391726 [info ] [MainThread]: adapter type: trino
[0m09:52:34.392412 [info ] [MainThread]: adapter version: 1.7.0
[0m09:52:34.442309 [info ] [MainThread]: Configuration:
[0m09:52:34.443294 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:52:34.444036 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:52:34.444728 [info ] [MainThread]: Required dependencies:
[0m09:52:34.445464 [debug] [MainThread]: Executing "git --help"
[0m09:52:34.447692 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:52:34.448415 [debug] [MainThread]: STDERR: "b''"
[0m09:52:34.449138 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:52:34.449875 [info ] [MainThread]: Connection:
[0m09:52:34.450581 [info ] [MainThread]:   host: trino
[0m09:52:34.451300 [info ] [MainThread]:   port: 8080
[0m09:52:34.451978 [info ] [MainThread]:   user: airflow
[0m09:52:34.452642 [info ] [MainThread]:   database: iceberg
[0m09:52:34.453332 [info ] [MainThread]:   schema: default
[0m09:52:34.454056 [info ] [MainThread]:   cert: None
[0m09:52:34.454725 [info ] [MainThread]:   prepared_statements_enabled: True
[0m09:52:34.455442 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:52:34.456264 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m09:52:34.459833 [debug] [MainThread]: Using trino connection "debug"
[0m09:52:34.460491 [debug] [MainThread]: On debug: select 1 as id
[0m09:52:34.461152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:34.478848 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:34.480282 [debug] [MainThread]: On debug: Close
[0m09:52:34.481075 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:52:34.481825 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:52:34.482896 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.21484968, "process_user_time": 1.80722, "process_kernel_time": 0.153339, "process_mem_max_rss": "187580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:34.483692 [debug] [MainThread]: Command `dbt debug` succeeded at 09:52:34.483574 after 0.22 seconds
[0m09:52:34.484357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:52:34.485042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f2200dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f21edae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f269e71d0>]}
[0m09:52:34.485779 [debug] [MainThread]: Flushing usage events
[0m09:52:38.410426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb603723c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb603721350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6037226d0>]}


============================== 09:52:38.415030 | cee50837-ee30-4be4-ae09-9202d2454ad8 ==============================
[0m09:52:38.415030 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:52:38.415994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:38.569981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb603769250>]}
[0m09:52:38.627527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6034ba7d0>]}
[0m09:52:38.628752 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:52:38.638107 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m09:52:38.742877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:38.743823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:38.749643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60340a650>]}
[0m09:52:38.771370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60347fe50>]}
[0m09:52:38.772364 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m09:52:38.773181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb603556d10>]}
[0m09:52:38.775491 [info ] [MainThread]: 
[0m09:52:38.776664 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:52:38.778421 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m09:52:38.779419 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m09:52:38.793651 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:52:38.796373 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m09:52:38.797321 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:52:38.798088 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m09:52:38.798825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:38.799588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:38.826039 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:38.826726 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:38.828294 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:52:38.829738 [debug] [ThreadPool]: On list_iceberg: Close
[0m09:52:38.832745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_staging)
[0m09:52:38.833572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_marts)
[0m09:52:38.840424 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m09:52:38.844145 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m09:52:38.844995 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m09:52:38.845809 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m09:52:38.846562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:38.847286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:38.914521 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:38.915224 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:38.916689 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m09:52:38.918282 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m09:52:38.919244 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m09:52:38.920061 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m09:52:38.922783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6033badd0>]}
[0m09:52:38.923652 [debug] [MainThread]: On master: COMMIT
[0m09:52:38.924659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:38.925490 [info ] [MainThread]: 
[0m09:52:38.933938 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m09:52:38.934499 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m09:52:38.935468 [info ] [Thread-1 (]: 1 of 4 START sql view model default_staging.stg_products ....................... [RUN]
[0m09:52:38.936443 [info ] [Thread-2 (]: 2 of 4 START sql view model default_staging.stg_sales .......................... [RUN]
[0m09:52:38.937643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_products)
[0m09:52:38.938894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_sales)
[0m09:52:38.939809 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m09:52:38.940597 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m09:52:38.942831 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m09:52:38.991453 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m09:52:38.995791 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 09:52:38.943667 => 09:52:38.995550
[0m09:52:38.996590 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m09:52:38.996980 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 09:52:38.941333 => 09:52:38.996794
[0m09:52:39.013734 [debug] [Thread-2 (]: Writing runtime sql for node "model.iceberg_example.stg_sales"
[0m09:52:39.014195 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m09:52:39.017928 [debug] [Thread-1 (]: Writing runtime sql for node "model.iceberg_example.stg_products"
[0m09:52:39.022247 [debug] [Thread-2 (]: Using trino connection "model.iceberg_example.stg_sales"
[0m09:52:39.023222 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_sales"} */

  create or replace view
    "iceberg"."default_staging"."stg_sales"
  security definer
  as
    with source as (
    select * from iceberg.raw.sales
),

renamed as (
    select
        sale_id,
        product_id,
        quantity,
        total as total_amount,
        date as sale_date
    from source
)

select * from renamed
  
[0m09:52:39.024420 [debug] [Thread-1 (]: Using trino connection "model.iceberg_example.stg_products"
[0m09:52:39.025085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:39.025871 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.stg_products"} */

  create or replace view
    "iceberg"."default_staging"."stg_products"
  security definer
  as
    with source as (
    select * from iceberg.raw.products
),

renamed as (
    select
        id as product_id,
        name as product_name,
        category,
        price,
        date as created_date
    from source
)

select * from renamed
  
[0m09:52:39.028025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:39.058573 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.059341 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.072995 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 09:52:38.997462 => 09:52:39.072810
[0m09:52:39.075356 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 09:52:39.015463 => 09:52:39.075179
[0m09:52:39.076307 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: ROLLBACK
[0m09:52:39.077072 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: ROLLBACK
[0m09:52:39.077833 [debug] [Thread-2 (]: On model.iceberg_example.stg_sales: Close
[0m09:52:39.078597 [debug] [Thread-1 (]: On model.iceberg_example.stg_products: Close
[0m09:52:39.079868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60356b090>]}
[0m09:52:39.080843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60356aed0>]}
[0m09:52:39.081660 [info ] [Thread-2 (]: 2 of 4 OK created sql view model default_staging.stg_sales ..................... [[32mSUCCESS[0m in 0.14s]
[0m09:52:39.082569 [info ] [Thread-1 (]: 1 of 4 OK created sql view model default_staging.stg_products .................. [[32mSUCCESS[0m in 0.14s]
[0m09:52:39.083422 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m09:52:39.084261 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m09:52:39.086135 [debug] [Thread-4 (]: Began running node model.iceberg_example.sales_by_category
[0m09:52:39.086522 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m09:52:39.087221 [info ] [Thread-4 (]: 3 of 4 START sql table model default_marts.sales_by_category ................... [RUN]
[0m09:52:39.087960 [info ] [Thread-3 (]: 4 of 4 START sql table model default_marts.sales_by_product .................... [RUN]
[0m09:52:39.089000 [debug] [Thread-4 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_category'
[0m09:52:39.090172 [debug] [Thread-3 (]: Acquiring new trino connection 'model.iceberg_example.sales_by_product'
[0m09:52:39.090928 [debug] [Thread-4 (]: Began compiling node model.iceberg_example.sales_by_category
[0m09:52:39.091643 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m09:52:39.094729 [debug] [Thread-4 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m09:52:39.097467 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m09:52:39.101547 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 09:52:39.095372 => 09:52:39.101346
[0m09:52:39.102152 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (compile): 09:52:39.092269 => 09:52:39.101973
[0m09:52:39.102629 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m09:52:39.103370 [debug] [Thread-4 (]: Began executing node model.iceberg_example.sales_by_category
[0m09:52:39.134879 [debug] [Thread-3 (]: Writing runtime sql for node "model.iceberg_example.sales_by_product"
[0m09:52:39.135979 [debug] [Thread-4 (]: Writing runtime sql for node "model.iceberg_example.sales_by_category"
[0m09:52:39.143801 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:52:39.144741 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

  
    

    create table "iceberg"."default_marts"."sales_by_product__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_product as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price as unit_price,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date,
        count(distinct s.sale_id) as number_of_sales
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1, 2, 3, 4
)

select * from sales_by_product
    )
[0m09:52:39.146690 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:52:39.147334 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:39.148171 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

  
    

    create table "iceberg"."default_marts"."sales_by_category__dbt_tmp"
      
      
    as (
      with products as (
    select * from "iceberg"."default_staging"."stg_products"
),

sales as (
    select * from "iceberg"."default_staging"."stg_sales"
),

sales_by_category as (
    select
        p.category,
        count(distinct p.product_id) as number_of_products,
        sum(s.quantity) as total_quantity_sold,
        sum(s.total_amount) as total_revenue,
        avg(s.total_amount / s.quantity) as average_unit_price,
        min(s.sale_date) as first_sale_date,
        max(s.sale_date) as last_sale_date
    from products p
    inner join sales s on p.product_id = s.product_id
    group by 1
)

select * from sales_by_category
    )
[0m09:52:39.150208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:39.521665 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.522363 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.529137 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:52:39.532914 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:52:39.533910 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product" rename to "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m09:52:39.534788 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category" rename to "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m09:52:39.579588 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.580509 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.584324 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:52:39.589309 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:52:39.590831 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */
alter table "iceberg"."default_marts"."sales_by_category__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_category"
[0m09:52:39.592596 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */
alter table "iceberg"."default_marts"."sales_by_product__dbt_tmp" rename to "iceberg"."default_marts"."sales_by_product"
[0m09:52:39.625215 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.627187 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.640653 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m09:52:39.643863 [debug] [Thread-3 (]: Applying DROP to: "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m09:52:39.646230 [debug] [Thread-4 (]: Using trino connection "model.iceberg_example.sales_by_category"
[0m09:52:39.647502 [debug] [Thread-3 (]: Using trino connection "model.iceberg_example.sales_by_product"
[0m09:52:39.648273 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_category"} */

    drop table if exists "iceberg"."default_marts"."sales_by_category__dbt_backup"
[0m09:52:39.649032 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "node_id": "model.iceberg_example.sales_by_product"} */

    drop table if exists "iceberg"."default_marts"."sales_by_product__dbt_backup"
[0m09:52:39.877735 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.880690 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 09:52:39.103979 => 09:52:39.880510
[0m09:52:39.881298 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:39.882094 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: ROLLBACK
[0m09:52:39.884774 [debug] [Thread-4 (]: Timing info for model.iceberg_example.sales_by_category (execute): 09:52:39.124920 => 09:52:39.884573
[0m09:52:39.885614 [debug] [Thread-3 (]: On model.iceberg_example.sales_by_product: Close
[0m09:52:39.886395 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: ROLLBACK
[0m09:52:39.887643 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb603291110>]}
[0m09:52:39.888362 [debug] [Thread-4 (]: On model.iceberg_example.sales_by_category: Close
[0m09:52:39.889451 [info ] [Thread-3 (]: 4 of 4 OK created sql table model default_marts.sales_by_product ............... [[32mSUCCESS[0m in 0.80s]
[0m09:52:39.890768 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee50837-ee30-4be4-ae09-9202d2454ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6033c7550>]}
[0m09:52:39.891657 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m09:52:39.892744 [info ] [Thread-4 (]: 3 of 4 OK created sql table model default_marts.sales_by_category .............. [[32mSUCCESS[0m in 0.80s]
[0m09:52:39.894424 [debug] [Thread-4 (]: Finished running node model.iceberg_example.sales_by_category
[0m09:52:39.896945 [debug] [MainThread]: On master: COMMIT
[0m09:52:39.897959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:39.898699 [debug] [MainThread]: Connection 'model.iceberg_example.stg_products' was properly closed.
[0m09:52:39.899463 [debug] [MainThread]: Connection 'model.iceberg_example.stg_sales' was properly closed.
[0m09:52:39.900201 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_category' was properly closed.
[0m09:52:39.900958 [debug] [MainThread]: Connection 'model.iceberg_example.sales_by_product' was properly closed.
[0m09:52:39.901737 [info ] [MainThread]: 
[0m09:52:39.902552 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m09:52:39.903790 [debug] [MainThread]: Command end result
[0m09:52:39.921625 [info ] [MainThread]: 
[0m09:52:39.922587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:39.923450 [info ] [MainThread]: 
[0m09:52:39.924323 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:52:39.925503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.553993, "process_user_time": 2.342652, "process_kernel_time": 0.252962, "process_mem_max_rss": "187580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:39.926440 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:39.926284 after 1.55 seconds
[0m09:52:39.927187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb607f03410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb607ea8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb607fc7210>]}
[0m09:52:39.927964 [debug] [MainThread]: Flushing usage events
[0m09:52:43.329319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a08462d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0846250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0847c10>]}


============================== 09:52:43.333422 | f2c92c79-4ef5-4de1-9f8a-13f1c14fce50 ==============================
[0m09:52:43.333422 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:52:43.334279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:43.472956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0622450>]}
[0m09:52:43.528051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0e531d0>]}
[0m09:52:43.529071 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:52:43.537841 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m09:52:43.626046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:43.626772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:43.631619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a08861d0>]}
[0m09:52:43.639300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a05cacd0>]}
[0m09:52:43.640068 [info ] [MainThread]: Found 4 models, 31 tests, 0 sources, 0 exposures, 0 metrics, 420 macros, 0 groups, 0 semantic models
[0m09:52:43.640792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0868a10>]}
[0m09:52:43.643059 [info ] [MainThread]: 
[0m09:52:43.644106 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:52:43.645425 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_marts'
[0m09:52:43.646121 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_default_staging'
[0m09:52:43.658303 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_marts"
[0m09:52:43.661449 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_staging"
[0m09:52:43.662521 [debug] [ThreadPool]: On list_iceberg_default_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_marts'
[0m09:52:43.663326 [debug] [ThreadPool]: On list_iceberg_default_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "list_iceberg_default_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_staging'
[0m09:52:43.664049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:43.664706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:43.719299 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:43.719963 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:43.721345 [debug] [ThreadPool]: On list_iceberg_default_marts: ROLLBACK
[0m09:52:43.722617 [debug] [ThreadPool]: On list_iceberg_default_staging: ROLLBACK
[0m09:52:43.723356 [debug] [ThreadPool]: On list_iceberg_default_marts: Close
[0m09:52:43.724061 [debug] [ThreadPool]: On list_iceberg_default_staging: Close
[0m09:52:43.726800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c92c79-4ef5-4de1-9f8a-13f1c14fce50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0868a10>]}
[0m09:52:43.727865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:43.728635 [info ] [MainThread]: 
[0m09:52:43.734682 [debug] [Thread-1 (]: Began running node model.iceberg_example.stg_products
[0m09:52:43.735234 [debug] [Thread-2 (]: Began running node model.iceberg_example.stg_sales
[0m09:52:43.736330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_staging, now model.iceberg_example.stg_products)
[0m09:52:43.737506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_default_marts, now model.iceberg_example.stg_sales)
[0m09:52:43.738306 [debug] [Thread-1 (]: Began compiling node model.iceberg_example.stg_products
[0m09:52:43.739239 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.stg_sales
[0m09:52:43.741495 [debug] [Thread-1 (]: Writing injected SQL for node "model.iceberg_example.stg_products"
[0m09:52:43.743257 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.stg_sales"
[0m09:52:43.747578 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (compile): 09:52:43.739924 => 09:52:43.747367
[0m09:52:43.748161 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (compile): 09:52:43.742160 => 09:52:43.747972
[0m09:52:43.748667 [debug] [Thread-1 (]: Began executing node model.iceberg_example.stg_products
[0m09:52:43.749579 [debug] [Thread-2 (]: Began executing node model.iceberg_example.stg_sales
[0m09:52:43.750445 [debug] [Thread-1 (]: Timing info for model.iceberg_example.stg_products (execute): 09:52:43.750223 => 09:52:43.750240
[0m09:52:43.751252 [debug] [Thread-2 (]: Timing info for model.iceberg_example.stg_sales (execute): 09:52:43.751071 => 09:52:43.751076
[0m09:52:43.752381 [debug] [Thread-1 (]: Finished running node model.iceberg_example.stg_products
[0m09:52:43.753432 [debug] [Thread-2 (]: Finished running node model.iceberg_example.stg_sales
[0m09:52:43.754588 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:52:43.754958 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:52:43.755356 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:52:43.755742 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:52:43.756965 [debug] [Thread-4 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_category.6007d8b2d1'
[0m09:52:43.757946 [debug] [Thread-3 (]: Acquiring new trino connection 'test.iceberg_example.not_null_stg_products_created_date.db1f142e72'
[0m09:52:43.758870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_products, now test.iceberg_example.not_null_stg_products_price.2d147627d4)
[0m09:52:43.759883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.stg_sales, now test.iceberg_example.not_null_stg_products_product_id.6373b0acf3)
[0m09:52:43.760650 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:52:43.761378 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:52:43.762097 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:52:43.762792 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:52:43.772123 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_category.6007d8b2d1"
[0m09:52:43.775645 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_created_date.db1f142e72"
[0m09:52:43.779146 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_price.2d147627d4"
[0m09:52:43.783589 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_id.6373b0acf3"
[0m09:52:43.787951 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (compile): 09:52:43.763390 => 09:52:43.787763
[0m09:52:43.788650 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (compile): 09:52:43.776262 => 09:52:43.788467
[0m09:52:43.789065 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (compile): 09:52:43.779810 => 09:52:43.788887
[0m09:52:43.789608 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:52:43.790230 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (compile): 09:52:43.772701 => 09:52:43.790057
[0m09:52:43.790693 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:52:43.791419 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:52:43.792199 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_category.6007d8b2d1 (execute): 09:52:43.792024 => 09:52:43.792033
[0m09:52:43.792910 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:52:43.793715 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_products_price.2d147627d4 (execute): 09:52:43.793537 => 09:52:43.793543
[0m09:52:43.794471 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_products_product_id.6373b0acf3 (execute): 09:52:43.794304 => 09:52:43.794310
[0m09:52:43.795554 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_category.6007d8b2d1
[0m09:52:43.796344 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_products_created_date.db1f142e72 (execute): 09:52:43.796158 => 09:52:43.796163
[0m09:52:43.797425 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_products_price.2d147627d4
[0m09:52:43.798496 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_products_product_id.6373b0acf3
[0m09:52:43.799325 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:52:43.800433 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_products_created_date.db1f142e72
[0m09:52:43.801180 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:52:43.801948 [debug] [Thread-2 (]: Began running node model.iceberg_example.sales_by_category
[0m09:52:43.802885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_category.6007d8b2d1, now test.iceberg_example.not_null_stg_products_product_name.0b59e4b939)
[0m09:52:43.803682 [debug] [Thread-3 (]: Began running node model.iceberg_example.sales_by_product
[0m09:52:43.804623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_price.2d147627d4, now test.iceberg_example.unique_stg_products_product_id.7d950a1467)
[0m09:52:43.805547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_id.6373b0acf3, now model.iceberg_example.sales_by_category)
[0m09:52:43.806290 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:52:43.807214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_created_date.db1f142e72, now model.iceberg_example.sales_by_product)
[0m09:52:43.807942 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:52:43.808703 [debug] [Thread-2 (]: Began compiling node model.iceberg_example.sales_by_category
[0m09:52:43.852197 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_products_product_name.0b59e4b939"
[0m09:52:43.853004 [debug] [Thread-3 (]: Began compiling node model.iceberg_example.sales_by_product
[0m09:52:43.857859 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_products_product_id.7d950a1467"
[0m09:52:43.860442 [debug] [Thread-2 (]: Writing injected SQL for node "model.iceberg_example.sales_by_category"
[0m09:52:43.863563 [debug] [Thread-3 (]: Writing injected SQL for node "model.iceberg_example.sales_by_product"
[0m09:52:43.867452 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (compile): 09:52:43.858562 => 09:52:43.867256
[0m09:52:43.867878 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (compile): 09:52:43.809355 => 09:52:43.867676
[0m09:52:43.868252 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (compile): 09:52:43.861536 => 09:52:43.868066
[0m09:52:43.868676 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (compile): 09:52:43.853641 => 09:52:43.868497
[0m09:52:43.869190 [debug] [Thread-2 (]: Began executing node model.iceberg_example.sales_by_category
[0m09:52:43.870006 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:52:43.870745 [debug] [Thread-3 (]: Began executing node model.iceberg_example.sales_by_product
[0m09:52:43.871502 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:52:43.872380 [debug] [Thread-2 (]: Timing info for model.iceberg_example.sales_by_category (execute): 09:52:43.872194 => 09:52:43.872205
[0m09:52:43.873177 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_products_product_name.0b59e4b939 (execute): 09:52:43.873000 => 09:52:43.873006
[0m09:52:43.873948 [debug] [Thread-3 (]: Timing info for model.iceberg_example.sales_by_product (execute): 09:52:43.873770 => 09:52:43.873775
[0m09:52:43.874727 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_products_product_id.7d950a1467 (execute): 09:52:43.874556 => 09:52:43.874561
[0m09:52:43.875873 [debug] [Thread-2 (]: Finished running node model.iceberg_example.sales_by_category
[0m09:52:43.876974 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_products_product_name.0b59e4b939
[0m09:52:43.878076 [debug] [Thread-3 (]: Finished running node model.iceberg_example.sales_by_product
[0m09:52:43.879310 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_stg_products_product_id.7d950a1467
[0m09:52:43.880245 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:52:43.881260 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:52:43.882234 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:52:43.883407 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:52:43.884381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_category, now test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276)
[0m09:52:43.885314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_products_product_name.0b59e4b939, now test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12)
[0m09:52:43.886271 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.iceberg_example.sales_by_product, now test.iceberg_example.not_null_stg_sales_sale_date.b84165df57)
[0m09:52:43.887213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_products_product_id.7d950a1467, now test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929)
[0m09:52:43.887932 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:52:43.888648 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:52:43.889429 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:52:43.890120 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:52:43.893767 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276"
[0m09:52:43.897382 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12"
[0m09:52:43.900830 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_date.b84165df57"
[0m09:52:43.904209 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929"
[0m09:52:43.908506 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (compile): 09:52:43.890709 => 09:52:43.908295
[0m09:52:43.908898 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (compile): 09:52:43.898061 => 09:52:43.908720
[0m09:52:43.909603 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:52:43.910040 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (compile): 09:52:43.901531 => 09:52:43.909862
[0m09:52:43.910641 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:52:43.911046 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (compile): 09:52:43.894417 => 09:52:43.910867
[0m09:52:43.911709 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276 (execute): 09:52:43.911508 => 09:52:43.911514
[0m09:52:43.912429 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:52:43.913220 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_date.b84165df57 (execute): 09:52:43.913045 => 09:52:43.913050
[0m09:52:43.913967 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:52:43.915050 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276
[0m09:52:43.915852 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929 (execute): 09:52:43.915650 => 09:52:43.915655
[0m09:52:43.916931 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_date.b84165df57
[0m09:52:43.917791 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12 (execute): 09:52:43.917620 => 09:52:43.917624
[0m09:52:43.918718 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:52:43.919988 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929
[0m09:52:43.920764 [debug] [Thread-3 (]: Began running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:52:43.921836 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12
[0m09:52:43.922741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_product_id.f0a6c99276, now test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f)
[0m09:52:43.923505 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:52:43.924420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_date.b84165df57, now test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d)
[0m09:52:43.925180 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:52:43.925918 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:52:43.926872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_sale_id.6b07c53929, now test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521)
[0m09:52:43.927594 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:52:43.928526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_quantity.0198ea4c12, now test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8)
[0m09:52:43.932199 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f"
[0m09:52:43.932934 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:52:43.939049 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d"
[0m09:52:43.939703 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:52:43.943461 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521"
[0m09:52:43.948430 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8"
[0m09:52:43.949520 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (compile): 09:52:43.929236 => 09:52:43.949343
[0m09:52:43.950434 [debug] [Thread-3 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (compile): 09:52:43.933516 => 09:52:43.950256
[0m09:52:43.951136 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:52:43.951973 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (compile): 09:52:43.940738 => 09:52:43.951797
[0m09:52:43.952301 [debug] [Thread-3 (]: Began executing node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:52:43.953079 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f (execute): 09:52:43.952904 => 09:52:43.952909
[0m09:52:43.953815 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:52:43.954211 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (compile): 09:52:43.944570 => 09:52:43.954038
[0m09:52:43.954827 [debug] [Thread-3 (]: Timing info for test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d (execute): 09:52:43.954655 => 09:52:43.954660
[0m09:52:43.955924 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f
[0m09:52:43.956729 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521 (execute): 09:52:43.956554 => 09:52:43.956558
[0m09:52:43.957881 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:52:43.958952 [debug] [Thread-3 (]: Finished running node test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d
[0m09:52:43.959789 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:52:43.960828 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521
[0m09:52:43.961573 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8 (execute): 09:52:43.961401 => 09:52:43.961406
[0m09:52:43.962313 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:52:43.963217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_stg_sales_total_amount.a154cd757f, now test.iceberg_example.not_null_sales_by_category_category.99acef3343)
[0m09:52:43.964036 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:52:43.965081 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8
[0m09:52:43.966068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.relationships_stg_sales_product_id__product_id__ref_stg_products_.57e6472e6d, now test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad)
[0m09:52:43.966792 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:52:43.967716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_stg_sales_sale_id.8a4f7c9521, now test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d)
[0m09:52:43.968475 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:52:43.969253 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:52:43.972688 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_category.99acef3343"
[0m09:52:43.973404 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:52:43.974358 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_average_unit_price.2c4e24a1b8, now test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d)
[0m09:52:43.977728 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad"
[0m09:52:43.981623 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d"
[0m09:52:43.982385 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:52:43.986631 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d"
[0m09:52:43.988036 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (compile): 09:52:43.969853 => 09:52:43.987843
[0m09:52:43.988502 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (compile): 09:52:43.974984 => 09:52:43.988266
[0m09:52:43.988933 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (compile): 09:52:43.978812 => 09:52:43.988754
[0m09:52:43.989634 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:52:43.990387 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:52:43.991215 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:52:43.991952 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (compile): 09:52:43.983919 => 09:52:43.991767
[0m09:52:43.992343 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_category.99acef3343 (execute): 09:52:43.992163 => 09:52:43.992170
[0m09:52:43.993131 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad (execute): 09:52:43.992949 => 09:52:43.992954
[0m09:52:43.993959 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d (execute): 09:52:43.993777 => 09:52:43.993782
[0m09:52:43.994754 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:52:43.995951 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_category.99acef3343
[0m09:52:43.997079 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad
[0m09:52:43.998213 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d
[0m09:52:43.999012 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d (execute): 09:52:43.998835 => 09:52:43.998840
[0m09:52:43.999821 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:52:44.000554 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:52:44.001385 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:52:44.002518 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d
[0m09:52:44.003485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_category.99acef3343, now test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87)
[0m09:52:44.004467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_first_sale_date.da94c8c1ad, now test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd)
[0m09:52:44.005425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_last_sale_date.2da866280d, now test.iceberg_example.unique_sales_by_category_category.b77939e04a)
[0m09:52:44.006191 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:52:44.006940 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:52:44.007655 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:52:44.008365 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:52:44.009381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_number_of_products.cf0e6caa7d, now test.iceberg_example.not_null_sales_by_product_category.5dd1b81659)
[0m09:52:44.013418 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87"
[0m09:52:44.017642 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd"
[0m09:52:44.021581 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_category_category.b77939e04a"
[0m09:52:44.022415 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:52:44.027258 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_category.5dd1b81659"
[0m09:52:44.030784 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (compile): 09:52:44.018317 => 09:52:44.030599
[0m09:52:44.031430 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (compile): 09:52:44.009987 => 09:52:44.031251
[0m09:52:44.031941 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:52:44.032466 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (compile): 09:52:44.014215 => 09:52:44.032179
[0m09:52:44.032858 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (compile): 09:52:44.024358 => 09:52:44.032687
[0m09:52:44.033306 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:52:44.034098 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_category_category.b77939e04a (execute): 09:52:44.033917 => 09:52:44.033923
[0m09:52:44.034752 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:52:44.035471 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:52:44.036215 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87 (execute): 09:52:44.036047 => 09:52:44.036052
[0m09:52:44.037267 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_sales_by_category_category.b77939e04a
[0m09:52:44.038014 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd (execute): 09:52:44.037841 => 09:52:44.037845
[0m09:52:44.038799 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_category.5dd1b81659 (execute): 09:52:44.038629 => 09:52:44.038633
[0m09:52:44.039886 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87
[0m09:52:44.040638 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:52:44.041642 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd
[0m09:52:44.042661 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_category.5dd1b81659
[0m09:52:44.043449 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:52:44.044364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.unique_sales_by_category_category.b77939e04a, now test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e)
[0m09:52:44.045071 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:52:44.045869 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:52:44.046808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_quantity_sold.2e90e8fe87, now test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132)
[0m09:52:44.047526 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:52:44.048388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_category_total_revenue.fb1162affd, now test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e)
[0m09:52:44.049369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_category.5dd1b81659, now test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371)
[0m09:52:44.050082 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:52:44.053702 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e"
[0m09:52:44.054491 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:52:44.055308 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:52:44.058776 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132"
[0m09:52:44.062992 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e"
[0m09:52:44.067689 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371"
[0m09:52:44.068661 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (compile): 09:52:44.050710 => 09:52:44.068481
[0m09:52:44.070195 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:52:44.070952 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e (execute): 09:52:44.070779 => 09:52:44.070784
[0m09:52:44.072038 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e
[0m09:52:44.072959 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (compile): 09:52:44.055901 => 09:52:44.072780
[0m09:52:44.073330 [debug] [Thread-1 (]: Began running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:52:44.073702 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (compile): 09:52:44.059867 => 09:52:44.073528
[0m09:52:44.074136 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (compile): 09:52:44.063656 => 09:52:44.073961
[0m09:52:44.074715 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:52:44.075622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_first_sale_date.438dd7814e, now test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710)
[0m09:52:44.076356 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:52:44.077044 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:52:44.077810 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132 (execute): 09:52:44.077641 => 09:52:44.077645
[0m09:52:44.078508 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:52:44.079351 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e (execute): 09:52:44.079148 => 09:52:44.079153
[0m09:52:44.080093 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371 (execute): 09:52:44.079928 => 09:52:44.079932
[0m09:52:44.081151 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132
[0m09:52:44.084522 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710"
[0m09:52:44.085567 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e
[0m09:52:44.086573 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371
[0m09:52:44.087299 [debug] [Thread-2 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:52:44.088497 [debug] [Thread-3 (]: Began running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:52:44.089378 [debug] [Thread-4 (]: Began running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:52:44.090263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_last_sale_date.710c299132, now test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873)
[0m09:52:44.091194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_number_of_sales.cee084b06e, now test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6)
[0m09:52:44.092113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_id.0f982d1371, now test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc)
[0m09:52:44.092858 [debug] [Thread-2 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:52:44.093592 [debug] [Thread-3 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:52:44.094074 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (compile): 09:52:44.081728 => 09:52:44.093898
[0m09:52:44.094665 [debug] [Thread-4 (]: Began compiling node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:52:44.098115 [debug] [Thread-2 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873"
[0m09:52:44.101574 [debug] [Thread-3 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6"
[0m09:52:44.102311 [debug] [Thread-1 (]: Began executing node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:52:44.105606 [debug] [Thread-4 (]: Writing injected SQL for node "test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc"
[0m09:52:44.107278 [debug] [Thread-1 (]: Timing info for test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710 (execute): 09:52:44.107103 => 09:52:44.107108
[0m09:52:44.108821 [debug] [Thread-1 (]: Finished running node test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710
[0m09:52:44.109679 [debug] [Thread-1 (]: Began running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:52:44.110100 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (compile): 09:52:44.095259 => 09:52:44.109923
[0m09:52:44.110498 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (compile): 09:52:44.098798 => 09:52:44.110322
[0m09:52:44.111309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.iceberg_example.not_null_sales_by_product_product_name.bafc63c710, now test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c)
[0m09:52:44.111727 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (compile): 09:52:44.102921 => 09:52:44.111555
[0m09:52:44.112301 [debug] [Thread-2 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:52:44.113009 [debug] [Thread-3 (]: Began executing node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:52:44.113714 [debug] [Thread-1 (]: Began compiling node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:52:44.114414 [debug] [Thread-4 (]: Began executing node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:52:44.115170 [debug] [Thread-2 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873 (execute): 09:52:44.114997 => 09:52:44.115002
[0m09:52:44.115900 [debug] [Thread-3 (]: Timing info for test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6 (execute): 09:52:44.115733 => 09:52:44.115738
[0m09:52:44.119302 [debug] [Thread-1 (]: Writing injected SQL for node "test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c"
[0m09:52:44.120101 [debug] [Thread-4 (]: Timing info for test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc (execute): 09:52:44.119930 => 09:52:44.119935
[0m09:52:44.121148 [debug] [Thread-2 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873
[0m09:52:44.122190 [debug] [Thread-3 (]: Finished running node test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6
[0m09:52:44.123654 [debug] [Thread-4 (]: Finished running node test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc
[0m09:52:44.128154 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (compile): 09:52:44.116469 => 09:52:44.127963
[0m09:52:44.128890 [debug] [Thread-1 (]: Began executing node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:52:44.129677 [debug] [Thread-1 (]: Timing info for test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c (execute): 09:52:44.129494 => 09:52:44.129500
[0m09:52:44.130759 [debug] [Thread-1 (]: Finished running node test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c
[0m09:52:44.132466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:44.133169 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_quantity_sold.965d187873' was properly closed.
[0m09:52:44.133929 [debug] [MainThread]: Connection 'test.iceberg_example.unique_sales_by_product_product_id.cc066b1b6c' was properly closed.
[0m09:52:44.134603 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_unit_price.af72cd72cc' was properly closed.
[0m09:52:44.135266 [debug] [MainThread]: Connection 'test.iceberg_example.not_null_sales_by_product_total_revenue.da0e64c3e6' was properly closed.
[0m09:52:44.138311 [debug] [MainThread]: Command end result
[0m09:52:44.163974 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m09:52:44.164623 [info ] [MainThread]: Building catalog
[0m09:52:44.166191 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m09:52:44.187502 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m09:52:44.188417 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "iceberg_example", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_products'
                    )
                 or 
                    (
                        table_schema = 'default_staging'
                        and table_name = 'stg_sales'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_category'
                    )
                 or 
                    (
                        table_schema = 'default_marts'
                        and table_name = 'sales_by_product'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_products'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_staging'
                    and table_name = 'stg_sales'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_category'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'default_marts'
                    and table_name = 'sales_by_product'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m09:52:44.189296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:44.403230 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:52:44.407898 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m09:52:44.424260 [info ] [MainThread]: Catalog written to /opt/airflow/dbt_project/target/catalog.json
[0m09:52:44.425436 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1294286, "process_user_time": 2.263463, "process_kernel_time": 0.215567, "process_mem_max_rss": "187580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:44.426368 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:52:44.426247 after 1.13 seconds
[0m09:52:44.427056 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:52:44.427710 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m09:52:44.428439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a5302390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0e533d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a51072d0>]}
[0m09:52:44.429223 [debug] [MainThread]: Flushing usage events
